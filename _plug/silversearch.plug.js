var It=Object.create;var ye=Object.defineProperty;var ct=Object.getOwnPropertyDescriptor;var mt=Object.getOwnPropertyNames;var ft=Object.getPrototypeOf,dt=Object.prototype.hasOwnProperty;var Z=(n,e)=>()=>(e||n((e={exports:{}}).exports,e),e.exports),Y=(n,e)=>{for(var t in e)ye(n,t,{get:e[t],enumerable:!0})},lt=(n,e,t,s)=>{if(e&&typeof e=="object"||typeof e=="function")for(let r of mt(e))!dt.call(n,r)&&r!==t&&ye(n,r,{get:()=>e[r],enumerable:!(s=ct(e,r))||s.enumerable});return n};var Qe=(n,e,t)=>(t=n!=null?It(ft(n)):{},lt(e||!n||!n.__esModule?ye(t,"default",{value:n,enumerable:!0}):t,n));var vn=Z((mP,Mn)=>{var Rr=/\r\n?|\n/g,jr=/\0/g;function _r(n){let e;return e=n.replace(Rr,`
`),e=e.replace(jr,"\uFFFD"),e}Mn.exports={normalize:_r}});var jn=Z((fP,Rn)=>{var qr=(n,e)=>{let t=0,s=0,r=0;for(;t<n.length&&s<e.length;)n[t]===e[s]&&(r+=1,t+=1),s+=1;return n.slice(0,r)};Rn.exports={maxMatchingSubstring:qr}});var Cn=Z((dP,Dn)=>{var{normalize:Dr}=vn(),{maxMatchingSubstring:Cr}=jn(),qn=n=>n.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&"),Wr=({link:n,startSyntax:e,endSyntax:t,links:s})=>{if(n.startsWith(e)){if(n.endsWith(t))return!1;if(n.includes(t)){let o=n.replace(/.?http/g,"http").substring(0,n.lastIndexOf(t)).replace(new RegExp(`\\${t}$`,"g"),"");return!s.some(i=>i.href===o)}}return!0},Vr=n=>{let e=/mailto:([^\s[;]+)/g;return n.map(t=>t.href.match(e)||t.href.includes("@")?{...t,href:t.href.startsWith("mailto")?t.href:`mailto:${t.href}`,type:"email"}:t)},_n=n=>n.startsWith("http")||n.startsWith("/")||n.includes("@"),ze=({line:n,url:e,lineLinks:t=[]})=>{let s=n?.match(new RegExp(qn(e),"g"))?.length||0,r=t?.reduce((u,o)=>u+(o.href.includes(e)?1:0)+(o.format==="[]()"&&o.text.includes(e)?1:0),0);return s>0&&r<s},Nr=({line:n,links:e,link:t})=>{let s="",r=(t?.match(/https:\/\/.*/g)?.[0]||"").replace("https://","");for(let u of e){let o=Cr(r,u.href);o.length>s.length&&(s=o)}if(s.length>0){let u=n?.match(new RegExp(qn(s),"g"))?.length||0,o=e?.reduce((i,I)=>i+(I.href.includes(s)?1:0)+(I.format==="[]()"&&I.text.includes(s)?1:0),0);return u>0&&o<u}return!0},Lr=n=>{let e=Dr(n).split(`
`),t=/.?\[([^\]]*)\]\(([^\][]*)\)/g,s=/<[^>]*>/g,r=/.?\(([^)]*)\)/g,u=/.?https?:\/\/[^\s[;]+/g,o=[];for(let i of e){let I=i.match(t)||[],p=i.match(s)||[],l=i.match(r)||[],d=i.match(u)||[],m=[];for(let T of I)if(!T.startsWith("!")){let h=T?.replace(/^.?\[/g,"[")||"",y=h?.match(/\(/g)?.length||0;(h?.match(/\)/g)?.length||0)>y&&(h=h?.replace(/\)$/g,"")||""),h.includes(") (")&&(h=h.replace(/\) \(.*/g,")"));let g=/\[([^\]]*)\]/,k=h?.match(g)?.[1]?.trim()||"",_=h?.replace(g,"")?.match(/\(([^\][]*)\)$/)?.[1]?.trim()||"",q={text:k,href:_,line:i,raw:h,type:"link",format:"[]()"};o.push(q),m.push(q)}for(let T of p){let h=T.match(/<([^>]*)>/)[1]?.trim();if(_n(h)){let y=h;if(ze({line:i,url:y,lineLinks:m})){let x={text:h,href:y,line:i,raw:T,type:"link",format:"<>"};o.push(x),m.push(x)}}}for(let T of l){let h=T.replace(/^.?\(/g,"("),y=h.match(/\(([^)]*)\)/)[1].trim();if(!T.startsWith("]")&&_n(y)){let x=y;if(ze({line:i,url:x,lineLinks:m})){let g={text:y,href:x,line:i,raw:h,type:"link",format:"()"};o.push(g),m.push(g)}}}for(let T of d)if([{start:"[",end:"]"},{start:"<",end:">"},{start:"(",end:")"}].every(y=>Wr({link:T,startSyntax:y.start,endSyntax:y.end,links:m}))&&Nr({line:i,links:m,link:T})){let y=T.replace(/^.?http/g,"http"),x=y;if(ze({line:i,url:x,lineLinks:m})){let g={text:y,href:x,line:i,raw:y,type:"link",format:"raw"};o.push(g),m.push(g)}}}return Vr(o)};Dn.exports={extractMdLinks:Lr}});var Jn=Z(le=>{le.parse=function(n,e){if(e?e.offsets=typeof e.offsets>"u"?!0:e.offsets:e={offsets:!0},n||(n=""),n.indexOf(":")===-1&&!e.tokenize)return n;if(!e.keywords&&!e.ranges&&!e.tokenize)return n;var t={text:[]};e.offsets&&(t.offsets=[]);for(var s={},r=[],u=/(\S+:'(?:[^'\\]|\\.)*')|(\S+:"(?:[^"\\]|\\.)*")|(-?"(?:[^"\\]|\\.)*")|(-?'(?:[^'\\]|\\.)*')|\S+|\S+:\S+/g,o;(o=u.exec(n))!==null;){var m=o[0],i=m.indexOf(":");if(i!==-1){var I=m.split(":"),p=m.slice(0,i),l=m.slice(i+1);l=l.replace(/^\"|\"$|^\'|\'$/g,""),l=(l+"").replace(/\\(.?)/g,function(D,v){switch(v){case"\\":return"\\";case"0":return"\0";case"":return"";default:return v}}),r.push({keyword:p,value:l,offsetStart:o.index,offsetEnd:o.index+m.length})}else{var d=!1;m[0]==="-"&&(d=!0,m=m.slice(1)),m=m.replace(/^\"|\"$|^\'|\'$/g,""),m=(m+"").replace(/\\(.?)/g,function(D,v){switch(v){case"\\":return"\\";case"0":return"\0";case"":return"";default:return v}}),d?s.text?(s.text instanceof Array||(s.text=[s.text]),s.text.push(m)):s.text=m:r.push({text:m,offsetStart:o.index,offsetEnd:o.index+m.length})}}r.reverse();for(var m;m=r.pop();)if(m.text)t.text.push(m.text),e.offsets&&t.offsets.push(m);else{var p=m.keyword;e.keywords=e.keywords||[];var T=!1,h=!1;if(!/^-/.test(p))T=e.keywords.indexOf(p)!==-1;else if(p[0]==="-"){var y=p.slice(1);T=e.keywords.indexOf(y)!==-1,T&&(p=y,h=!0)}e.ranges=e.ranges||[];var x=e.ranges.indexOf(p)!==-1;if(T){e.offsets&&t.offsets.push({keyword:p,value:m.value,offsetStart:h?m.offsetStart+1:m.offsetStart,offsetEnd:m.offsetEnd});var g=m.value;if(g.length){var k=g.split(",");h?s[p]?s[p]instanceof Array?k.length>1?s[p]=s[p].concat(k):s[p].push(g):(s[p]=[s[p]],s[p].push(g)):k.length>1?s[p]=k:e.alwaysArray?s[p]=[g]:s[p]=g:t[p]?t[p]instanceof Array?k.length>1?t[p]=t[p].concat(k):t[p].push(g):(t[p]=[t[p]],t[p].push(g)):k.length>1?t[p]=k:e.alwaysArray?t[p]=[g]:t[p]=g}}else if(x){e.offsets&&t.offsets.push(m);var g=m.value,_=g.split("-");t[p]={},_.length===2?(t[p].from=_[0],t[p].to=_[1]):!_.length%2||(t[p].from=g)}else{var q=m.keyword+":"+m.value;t.text.push(q),e.offsets&&t.offsets.push({text:q,offsetStart:m.offsetStart,offsetEnd:m.offsetEnd})}}return t.text.length?e.tokenize||(t.text=t.text.join(" ").trim()):delete t.text,t.exclude=s,t};le.stringify=function(n,e,t){if(e||(e={offsets:!0}),!n)return"";if(typeof n=="string")return n;if(Array.isArray(n))return n.join(" ");if(!Object.keys(n).length)return"";if(Object.keys(n).length===3&&n.text&&n.offsets&&n.exclude&&typeof n.text=="string")return n.text;t||(t="");var s=function(i){return i.indexOf(" ")>-1?JSON.stringify(i):i},r=function(i){return t+i},u=[];if(n.text){var o=[];typeof n.text=="string"?o.push(n.text):o.push.apply(o,n.text),o.length>0&&u.push(o.map(s).map(r).join(" "))}return e.keywords&&e.keywords.forEach(function(i){if(n[i]){var I=[];typeof n[i]=="string"?I.push(n[i]):I.push.apply(I,n[i]),I.length>0&&u.push(r(i+":"+I.map(s).join(",")))}}),e.ranges&&e.ranges.forEach(function(i){if(n[i]){var I=n[i].from,p=n[i].to;p&&(I=I+"-"+p),I&&u.push(r(i+":"+I))}}),n.exclude&&Object.keys(n.exclude).length>0&&u.push(le.stringify(n.exclude,e,"-")),u.join(" ")}});var Xn=Z((YP,Hn)=>{Hn.exports=Jn()});function Ze(n){let e=atob(n),t=e.length,s=new Uint8Array(t);for(let r=0;r<t;r++)s[r]=e.charCodeAt(r);return s}function he(n){typeof n=="string"&&(n=new TextEncoder().encode(n));let e="",t=n.byteLength;for(let s=0;s<t;s++)e+=String.fromCharCode(n[s]);return btoa(e)}var Gr=new Uint8Array(16);var xe=class{constructor(e="",t=1e3){this.prefix=e;this.maxCaptureSize=t;this.prefix=e,this.originalConsole={log:console.log.bind(console),info:console.info.bind(console),warn:console.warn.bind(console),error:console.error.bind(console),debug:console.debug.bind(console)},this.patchConsole()}originalConsole;logBuffer=[];patchConsole(){let e=t=>(...s)=>{let r=this.prefix?[this.prefix,...s]:s;this.originalConsole[t](...r),this.captureLog(t,s)};console.log=e("log"),console.info=e("info"),console.warn=e("warn"),console.error=e("error"),console.debug=e("debug")}captureLog(e,t){let s={level:e,timestamp:Date.now(),message:t.map(r=>{if(typeof r=="string")return r;try{return JSON.stringify(r)}catch{return String(r)}}).join(" ")};this.logBuffer.push(s),this.logBuffer.length>this.maxCaptureSize&&this.logBuffer.shift()}async postToServer(e,t){if(this.logBuffer.length>0){let r=[...this.logBuffer];this.logBuffer=[];try{if(!(await fetch(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r.map(o=>({...o,source:t})))})).ok)throw new Error("Failed to post logs to server")}catch(u){console.warn("Could not post logs to server",u.message),this.logBuffer.unshift(...r)}}}},Ye;function en(n=""){return Ye=new xe(n),Ye}var ee=n=>{throw new Error("Not initialized yet")},we=typeof window>"u"&&typeof globalThis.WebSocketPair>"u";typeof Deno>"u"&&(self.Deno={args:[],build:{arch:"x86_64"},env:{get(){}}});var ke=new Map,ge=0;we&&(globalThis.syscall=async(n,...e)=>await new Promise((t,s)=>{ge++,ke.set(ge,{resolve:t,reject:s}),ee({type:"sys",id:ge,name:n,args:e})}));function nn(n,e,t){we&&(ee=t,self.addEventListener("message",s=>{(async()=>{let r=s.data;switch(r.type){case"inv":{let u=n[r.name];if(!u)throw new Error(`Function not loaded: ${r.name}`);try{let o=await Promise.resolve(u(...r.args||[]));ee({type:"invr",id:r.id,result:o})}catch(o){console.error("An exception was thrown as a result of invoking function",r.name,"error:",o.message),ee({type:"invr",id:r.id,error:o.message})}}break;case"sysr":{let u=r.id,o=ke.get(u);if(!o)throw Error("Invalid request id");ke.delete(u),r.error?o.reject(new Error(r.error)):o.resolve(r.result)}break}})().catch(console.error)}),ee({type:"manifest",manifest:e}),en(`[${e.name} plug]`))}async function Tt(n,e){if(typeof n!="string"){let t=new Uint8Array(await n.arrayBuffer()),s=t.length>0?he(t):void 0;e={method:n.method,headers:Object.fromEntries(n.headers.entries()),base64Body:s},n=n.url}return syscall("sandboxFetch.fetch",n,e)}globalThis.nativeFetch=globalThis.fetch;function yt(){globalThis.fetch=async function(n,e){let t=e&&e.body?he(new Uint8Array(await new Response(e.body).arrayBuffer())):void 0,s=await Tt(n,e&&{method:e.method,headers:e.headers,base64Body:t});return new Response(s.base64Body?Ze(s.base64Body):null,{status:s.status,headers:s.headers})}}we&&yt();var B={};Y(B,{alert:()=>ns,configureVimMode:()=>ys,confirm:()=>es,copyToClipboard:()=>ms,deleteLine:()=>fs,dispatch:()=>Zt,downloadFile:()=>Nt,filterBox:()=>Kt,flashNotification:()=>Ft,fold:()=>rs,foldAll:()=>is,getCurrentEditor:()=>wt,getCurrentPage:()=>ht,getCurrentPageMeta:()=>xt,getCurrentPath:()=>gt,getCursor:()=>At,getRecentlyOpenedPages:()=>kt,getSelection:()=>Bt,getText:()=>Ot,getUiOption:()=>ts,goHistory:()=>Vt,hidePanel:()=>zt,insertAtCursor:()=>Qt,insertAtPos:()=>Gt,invokeCommand:()=>Pt,moveCursor:()=>Ht,moveCursorToLine:()=>Xt,moveLineDown:()=>ls,moveLineUp:()=>ds,navigate:()=>Mt,newWindow:()=>Wt,openCommandPalette:()=>Rt,openPageNavigator:()=>vt,openSearchPanel:()=>cs,openUrl:()=>Ct,prompt:()=>Yt,rebuildEditorState:()=>qt,redo:()=>Is,reloadConfigAndCommands:()=>Dt,reloadPage:()=>jt,reloadUI:()=>_t,replaceRange:()=>Jt,save:()=>Et,sendMessage:()=>hs,setSelection:()=>bt,setText:()=>St,setUiOption:()=>ss,showPanel:()=>$t,showProgress:()=>Ut,toggleFold:()=>os,undo:()=>ps,unfold:()=>us,unfoldAll:()=>as,uploadFile:()=>Lt,vimEx:()=>Ts});typeof self>"u"&&(self={syscall:()=>{throw new Error("Not implemented here")}});function c(n,...e){return globalThis.syscall(n,...e)}function ht(){return c("editor.getCurrentPage")}function xt(){return c("editor.getCurrentPageMeta")}function gt(){return c("editor.getCurrentPath")}function kt(){return c("editor.getRecentlyOpenedPages")}function wt(){return c("editor.getCurrentEditor")}function Ot(){return c("editor.getText")}function St(n,e=!1){return c("editor.setText",n,e)}function At(){return c("editor.getCursor")}function Bt(){return c("editor.getSelection")}function bt(n,e){return c("editor.setSelection",n,e)}function Pt(n,e){return c("editor.invokeCommand",n,e)}function Et(){return c("editor.save")}function Mt(n,e=!1,t=!1){return c("editor.navigate",n,e,t)}function vt(n="page"){return c("editor.openPageNavigator",n)}function Rt(){return c("editor.openCommandPalette")}function jt(){return c("editor.reloadPage")}function _t(){return c("editor.reloadUI")}function qt(){return c("editor.rebuildEditorState")}function Dt(){return c("editor.reloadConfigAndCommands")}function Ct(n,e=!1){return c("editor.openUrl",n,e)}function Wt(){return c("editor.newWindow")}function Vt(n){return c("editor.goHistory",n)}function Nt(n,e){return c("editor.downloadFile",n,e)}function Lt(n,e){return c("editor.uploadFile",n,e)}function Ft(n,e="info"){return c("editor.flashNotification",n,e)}function Kt(n,e,t="",s=""){return c("editor.filterBox",n,e,t,s)}function $t(n,e,t,s=""){return c("editor.showPanel",n,e,t,s)}function zt(n){return c("editor.hidePanel",n)}function Ut(n,e){return c("editor.showProgress",n,e)}function Gt(n,e){return c("editor.insertAtPos",n,e)}function Jt(n,e,t){return c("editor.replaceRange",n,e,t)}function Ht(n,e=!1){return c("editor.moveCursor",n,e)}function Xt(n,e=1,t=!1){return c("editor.moveCursorToLine",n,e,t)}function Qt(n,e=!1,t=!1){return c("editor.insertAtCursor",n,e,t)}function Zt(n){return c("editor.dispatch",n)}function Yt(n,e=""){return c("editor.prompt",n,e)}function es(n){return c("editor.confirm",n)}function ns(n){return c("editor.alert",n)}function ts(n){return c("editor.getUiOption",n)}function ss(n,e){return c("editor.setUiOption",n,e)}function rs(){return c("editor.fold")}function us(){return c("editor.unfold")}function os(){return c("editor.toggleFold")}function is(){return c("editor.foldAll")}function as(){return c("editor.unfoldAll")}function ps(){return c("editor.undo")}function Is(){return c("editor.redo")}function cs(){return c("editor.openSearchPanel")}function ms(n){return c("editor.copyToClipboard",n)}function fs(){return c("editor.deleteLine")}function ds(){return c("editor.moveLineUp")}function ls(){return c("editor.moveLineDown")}function Ts(n){return c("editor.vimEx",n)}function ys(){return c("editor.configureVimMode")}function hs(n,e){return c("editor.sendMessage",n,e)}var R={};Y(R,{deleteDocument:()=>vs,deleteFile:()=>Ds,deletePage:()=>As,fileExists:()=>Cs,getDocumentMeta:()=>Ps,getFileMeta:()=>_s,getPageMeta:()=>ks,listDocuments:()=>bs,listFiles:()=>Rs,listPages:()=>gs,listPlugs:()=>Bs,pageExists:()=>ws,readDocument:()=>Es,readFile:()=>js,readPage:()=>Os,writeDocument:()=>Ms,writeFile:()=>qs,writePage:()=>Ss});function gs(){return c("space.listPages")}function ks(n){return c("space.getPageMeta",n)}function ws(n){return c("space.pageExists",n)}function Os(n){return c("space.readPage",n)}function Ss(n,e){return c("space.writePage",n,e)}function As(n){return c("space.deletePage",n)}function Bs(){return c("space.listPlugs")}function bs(){return c("space.listDocuments")}function Ps(n){return c("space.getDocumentMeta",n)}function Es(n){return c("space.readDocument",n)}function Ms(n,e){return c("space.writeDocument",n,e)}function vs(n){return c("space.deleteDocument",n)}function Rs(){return c("space.listFiles")}function js(n){return c("space.readFile",n)}function _s(n){return c("space.getFileMeta",n)}function qs(n,e){return c("space.writeFile",n,e)}function Ds(n){return c("space.deleteFile",n)}function Cs(n){return c("space.fileExists",n)}var ae={};Y(ae,{getConfig:()=>zs,getMode:()=>Ks,getVersion:()=>$s,invokeCommand:()=>Vs,invokeFunction:()=>Ws,listCommands:()=>Ns,listSyscalls:()=>Ls,reloadPlugs:()=>Fs,wipeClient:()=>Us});function Ws(n,...e){return c("system.invokeFunction",n,...e)}function Vs(n,e){return c("system.invokeCommand",n,e)}function Ns(){return c("system.listCommands")}function Ls(){return c("system.listSyscalls")}function Fs(){return c("system.reloadPlugs")}function Ks(){return c("system.getMode")}function $s(){return c("system.getVersion")}function zs(n,e=void 0){return c("system.getConfig",n,e)}function Us(n=!1){return c("system.wipeClient",n)}var z={};Y(z,{del:()=>Hs,get:()=>Js,set:()=>Gs});function Gs(n,e){return c("clientStore.set",n,e)}function Js(n){return c("clientStore.get",n)}function Hs(n){return c("clientStore.delete",n)}var pe={};Y(pe,{dispatchEvent:()=>er,listEvents:()=>nr});function er(n,e,t){return new Promise((s,r)=>{let u=-1;t&&(u=setTimeout(()=>{console.log("Timeout!"),r("timeout")},t)),c("event.dispatch",n,e).then(o=>{u!==-1&&clearTimeout(u),s(o)}).catch(r)})}function nr(){return c("event.listEvents")}var Oe='var Zl=Object.defineProperty;var vr=P=>{throw TypeError(P)};var Jl=(P,S,D)=>S in P?Zl(P,S,{enumerable:!0,configurable:!0,writable:!0,value:D}):P[S]=D;var ft=(P,S,D)=>Jl(P,typeof S!="symbol"?S+"":S,D),ln=(P,S,D)=>S.has(P)||vr("Cannot "+D);var k=(P,S,D)=>(ln(P,S,"read from private field"),D?D.call(P):S.get(P)),Y=(P,S,D)=>S.has(P)?vr("Cannot add the same private member more than once"):S instanceof WeakSet?S.add(P):S.set(P,D),J=(P,S,D,Me)=>(ln(P,S,"write to private field"),Me?Me.call(P,D):S.set(P,D),D),De=(P,S,D)=>(ln(P,S,"access private method"),D);(function(){"use strict";var Be,We,me,lt,it,Pe,He,Re,we,ze,at,st,ne,dr,Pt,an,cr;var S=Array.isArray,D=Array.prototype.indexOf,Me=Array.from,Rt=Object.defineProperty,Ne=Object.getOwnPropertyDescriptor,_r=Object.prototype,hr=Array.prototype,pr=Object.getPrototypeOf,sn=Object.isExtensible;const gr=()=>{};function un(e){for(var t=0;t<e.length;t++)e[t]()}function mr(){var e,t,n=new Promise((r,i)=>{e=r,t=i});return{promise:n,resolve:e,reject:t}}const B=2,At=4,Ct=8,Le=16,se=32,Ee=64,fn=128,z=256,ot=512,N=1024,$=2048,fe=4096,ee=8192,be=16384,Dt=32768,ct=65536,on=1<<17,wr=1<<18,Mt=1<<19,yr=1<<20,Nt=1<<21,Lt=1<<22,ke=1<<23,Ge=Symbol("$state"),Er=Symbol("legacy props"),Ft=new class extends Error{constructor(){super(...arguments);ft(this,"name","StaleReactionError");ft(this,"message","The reaction that called `getAbortSignal()` was re-run or destroyed")}};function br(){throw new Error("https://svelte.dev/e/await_outside_boundary")}function kr(){throw new Error("https://svelte.dev/e/async_derived_orphan")}function xr(e){throw new Error("https://svelte.dev/e/effect_in_teardown")}function Tr(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function Sr(e){throw new Error("https://svelte.dev/e/effect_orphan")}function qr(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function Pr(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function Rr(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function Ar(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}const Cr=1,Dr=2,Mr=16,Nr=1,Lr=2,M=Symbol();let Fr=!1;function cn(e){return e===this.v}function Ir(e,t){return e!=e?t==t:e!==t||e!==null&&typeof e=="object"||typeof e=="function"}function vn(e){return!Ir(e,this.v)}let vt=!1,$l=!1;function Or(){vt=!0}let L=null;function dt(e){L=e}function Fe(e,t=!1,n){L={p:L,c:null,e:null,s:e,x:null,l:vt&&!t?{s:null,u:null,$:[]}:null}}function Ie(e){var t=L,n=t.e;if(n!==null){t.e=null;for(var r of n)An(r)}return L=t.p,{}}function Oe(){return!vt||L!==null&&L.l===null}const Ur=new WeakMap;function Vr(e){var t=b;if(t===null)return E.f|=ke,e;if((t.f&Dt)===0){if((t.f&fn)===0)throw!t.parent&&e instanceof Error&&dn(e),e;t.b.error(e)}else It(e,t)}function It(e,t){for(;t!==null;){if((t.f&fn)!==0)try{t.b.error(e);return}catch(n){e=n}t=t.parent}throw e instanceof Error&&dn(e),e}function dn(e){const t=Ur.get(e);t&&(Rt(e,"message",{value:t.message}),Rt(e,"stack",{value:t.stack}))}let Qe=[],Ot=[];function _n(){var e=Qe;Qe=[],un(e)}function jr(){var e=Ot;Ot=[],un(e)}function hn(e){Qe.length===0&&queueMicrotask(_n),Qe.push(e)}function Kr(){Qe.length>0&&_n(),Ot.length>0&&jr()}function Yr(){for(var e=b.b;e!==null&&!e.has_pending_snippet();)e=e.parent;return e===null&&br(),e}function _t(e){var t=B|$,n=E!==null&&(E.f&B)!==0?E:null;return b===null||n!==null&&(n.f&z)!==0?t|=z:b.f|=Mt,{ctx:L,deps:null,effects:null,equals:cn,f:t,fn:e,reactions:null,rv:0,v:M,wv:0,parent:n??b,ac:null}}function Br(e,t){let n=b;n===null&&kr();var r=n.b,i=void 0,l=Je(M),a=null,u=!E;return al(()=>{try{var s=e()}catch(c){s=Promise.reject(c)}var f=()=>s;i=(a==null?void 0:a.then(f,f))??Promise.resolve(s),a=i;var d=q,_=r.pending;u&&(r.update_pending_count(1),_||d.increment());const v=(c,o=void 0)=>{a=null,_||d.activate(),o?o!==Ft&&(l.f|=ke,wt(l,o)):((l.f&ke)!==0&&(l.f^=ke),wt(l,c)),u&&(r.update_pending_count(-1),_||d.decrement()),wn()};if(i.then(v,c=>v(null,c||"unknown")),d)return()=>{queueMicrotask(()=>d.neuter())}}),new Promise(s=>{function f(d){function _(){d===i?s(l):f(i)}d.then(_,_)}f(i)})}function Ut(e){const t=_t(e);return Vn(t),t}function pn(e){const t=_t(e);return t.equals=vn,t}function gn(e){var t=e.effects;if(t!==null){e.effects=null;for(var n=0;n<t.length;n+=1)re(t[n])}}function Wr(e){for(var t=e.parent;t!==null;){if((t.f&B)===0)return t;t=t.parent}return null}function Vt(e){var t,n=b;he(Wr(e));try{gn(e),t=Wn(e)}finally{he(n)}return t}function mn(e){var t=Vt(e);if(e.equals(t)||(e.v=t,e.wv=Yn()),!Se)if(oe!==null)oe.set(e,e.v);else{var n=(pe||(e.f&z)!==0)&&e.deps!==null?fe:N;V(e,n)}}function Hr(e,t,n){const r=Oe()?_t:pn;if(t.length===0){n(e.map(r));return}var i=q,l=b,a=zr(),u=Yr();Promise.all(t.map(s=>Br(s))).then(s=>{i==null||i.activate(),a();try{n([...e.map(r),...s])}catch(f){(l.f&be)===0&&It(f,l)}i==null||i.deactivate(),wn()}).catch(s=>{u.error(s)})}function zr(){var e=b,t=E,n=L;return function(){he(e),ie(t),dt(n)}}function wn(){he(null),ie(null),dt(null)}const Xe=new Set;let q=null,ht=null,oe=null,yn=new Set,pt=[];function En(){const e=pt.shift();pt.length>0&&queueMicrotask(En),e()}let xe=[],gt=null,jt=!1,mt=!1;const qt=class qt{constructor(){Y(this,ne);ft(this,"current",new Map);Y(this,Be,new Map);Y(this,We,new Set);Y(this,me,0);Y(this,lt,null);Y(this,it,!1);Y(this,Pe,[]);Y(this,He,[]);Y(this,Re,[]);Y(this,we,[]);Y(this,ze,[]);Y(this,at,[]);Y(this,st,[]);ft(this,"skipped_effects",new Set)}process(t){var l;xe=[],ht=null;var n=null;if(Xe.size>1){n=new Map,oe=new Map;for(const[a,u]of this.current)n.set(a,{v:a.v,wv:a.wv}),a.v=u;for(const a of Xe)if(a!==this)for(const[u,s]of k(a,Be))n.has(u)||(n.set(u,{v:u.v,wv:u.wv}),u.v=s)}for(const a of t)De(this,ne,dr).call(this,a);if(k(this,Pe).length===0&&k(this,me)===0){De(this,ne,an).call(this);var r=k(this,Re),i=k(this,we);J(this,Re,[]),J(this,we,[]),J(this,ze,[]),ht=q,q=null,kn(r),kn(i),q===null?q=this:Xe.delete(this),(l=k(this,lt))==null||l.resolve()}else De(this,ne,Pt).call(this,k(this,Re)),De(this,ne,Pt).call(this,k(this,we)),De(this,ne,Pt).call(this,k(this,ze));if(n){for(const[a,{v:u,wv:s}]of n)a.wv<=s&&(a.v=u);oe=null}for(const a of k(this,Pe))Ke(a);for(const a of k(this,He))Ke(a);J(this,Pe,[]),J(this,He,[])}capture(t,n){k(this,Be).has(t)||k(this,Be).set(t,n),this.current.set(t,t.v)}activate(){q=this}deactivate(){q=null,ht=null;for(const t of yn)if(yn.delete(t),t(),q!==null)break}neuter(){J(this,it,!0)}flush(){xe.length>0?bn():De(this,ne,an).call(this),q===this&&(k(this,me)===0&&Xe.delete(this),this.deactivate())}increment(){J(this,me,k(this,me)+1)}decrement(){if(J(this,me,k(this,me)-1),k(this,me)===0){for(const t of k(this,at))V(t,$),Ue(t);for(const t of k(this,st))V(t,fe),Ue(t);J(this,Re,[]),J(this,we,[]),this.flush()}else this.deactivate()}add_callback(t){k(this,We).add(t)}settled(){return(k(this,lt)??J(this,lt,mr())).promise}static ensure(){if(q===null){const t=q=new qt;Xe.add(q),mt||qt.enqueue(()=>{q===t&&t.flush()})}return q}static enqueue(t){pt.length===0&&queueMicrotask(En),pt.unshift(t)}};Be=new WeakMap,We=new WeakMap,me=new WeakMap,lt=new WeakMap,it=new WeakMap,Pe=new WeakMap,He=new WeakMap,Re=new WeakMap,we=new WeakMap,ze=new WeakMap,at=new WeakMap,st=new WeakMap,ne=new WeakSet,dr=function(t){var d;t.f^=N;for(var n=t.first;n!==null;){var r=n.f,i=(r&(se|Ee))!==0,l=i&&(r&N)!==0,a=l||(r&ee)!==0||this.skipped_effects.has(n);if(!a&&n.fn!==null){if(i)n.f^=N;else if((r&At)!==0)k(this,we).push(n);else if((r&N)===0)if((r&Lt)!==0){var u=(d=n.b)!=null&&d.pending?k(this,He):k(this,Pe);u.push(n)}else kt(n)&&((n.f&Le)!==0&&k(this,ze).push(n),Ke(n));var s=n.first;if(s!==null){n=s;continue}}var f=n.parent;for(n=n.next;n===null&&f!==null;)n=f.next,f=f.parent}},Pt=function(t){for(const n of t)((n.f&$)!==0?k(this,at):k(this,st)).push(n),V(n,N);t.length=0},an=function(){if(!k(this,it))for(const t of k(this,We))t();k(this,We).clear()};let Ze=qt;function Gr(e){var t=mt;mt=!0;try{for(var n;;){if(Kr(),xe.length===0&&(q==null||q.flush(),xe.length===0))return gt=null,n;bn()}}finally{mt=t}}function bn(){var e=je;jt=!0;try{var t=0;for(On(!0);xe.length>0;){var n=Ze.ensure();if(t++>1e3){var r,i;Qr()}n.process(xe),ce.clear()}}finally{jt=!1,On(e),gt=null}}function Qr(){try{qr()}catch(e){It(e,gt)}}let Te=null;function kn(e){var t=e.length;if(t!==0){for(var n=0;n<t;){var r=e[n++];if((r.f&(be|ee))===0&&kt(r)&&(Te=[],Ke(r),r.deps===null&&r.first===null&&r.nodes_start===null&&(r.teardown===null&&r.ac===null?Ln(r):r.fn=null),Te.length>0)){ce.clear();for(const i of Te)Ke(i);Te=[]}}Te=null}}function Ue(e){for(var t=gt=e;t.parent!==null;){t=t.parent;var n=t.f;if(jt&&t===b&&(n&Le)!==0)return;if((n&(Ee|se))!==0){if((n&N)===0)return;t.f^=N}}xe.push(t)}const ce=new Map;function Je(e,t){var n={f:0,v:e,reactions:null,equals:cn,rv:0,wv:0};return n}function F(e,t){const n=Je(e);return Vn(n),n}function Xr(e,t=!1,n=!0){var i;const r=Je(e);return t||(r.equals=vn),vt&&n&&L!==null&&L.l!==null&&((i=L.l).s??(i.s=[])).push(r),r}function x(e,t,n=!1){E!==null&&(!le||(E.f&on)!==0)&&Oe()&&(E.f&(B|Le|Lt|on))!==0&&!(I!=null&&I.includes(e))&&Ar();let r=n?ve(t):t;return wt(e,r)}function wt(e,t){if(!e.equals(t)){var n=e.v;Se?ce.set(e,t):ce.set(e,n),e.v=t;var r=Ze.ensure();r.capture(e,n),(e.f&B)!==0&&((e.f&$)!==0&&Vt(e),V(e,(e.f&z)===0?N:fe)),e.wv=Yn(),xn(e,$),Oe()&&b!==null&&(b.f&N)!==0&&(b.f&(se|Ee))===0&&(Q===null?ul([e]):Q.push(e))}return t}function yt(e,t=1){var n=p(e),r=t===1?n++:n--;return x(e,n),r}function Kt(e){x(e,e.v+1)}function xn(e,t){var n=e.reactions;if(n!==null)for(var r=Oe(),i=n.length,l=0;l<i;l++){var a=n[l],u=a.f;if(!(!r&&a===b)){var s=(u&$)===0;s&&V(a,t),(u&B)!==0?xn(a,fe):s&&((u&Le)!==0&&Te!==null&&Te.push(a),Ue(a))}}}function ve(e){if(typeof e!="object"||e===null||Ge in e)return e;const t=pr(e);if(t!==_r&&t!==hr)return e;var n=new Map,r=S(e),i=F(0),l=qe,a=u=>{if(qe===l)return u();var s=E,f=qe;ie(null),Kn(l);var d=u();return ie(s),Kn(f),d};return r&&n.set("length",F(e.length)),new Proxy(e,{defineProperty(u,s,f){(!("value"in f)||f.configurable===!1||f.enumerable===!1||f.writable===!1)&&Pr();var d=n.get(s);return d===void 0?d=a(()=>{var _=F(f.value);return n.set(s,_),_}):x(d,f.value,!0),!0},deleteProperty(u,s){var f=n.get(s);if(f===void 0){if(s in u){const d=a(()=>F(M));n.set(s,d),Kt(i)}}else x(f,M),Kt(i);return!0},get(u,s,f){var c;if(s===Ge)return e;var d=n.get(s),_=s in u;if(d===void 0&&(!_||(c=Ne(u,s))!=null&&c.writable)&&(d=a(()=>{var o=ve(_?u[s]:M),h=F(o);return h}),n.set(s,d)),d!==void 0){var v=p(d);return v===M?void 0:v}return Reflect.get(u,s,f)},getOwnPropertyDescriptor(u,s){var f=Reflect.getOwnPropertyDescriptor(u,s);if(f&&"value"in f){var d=n.get(s);d&&(f.value=p(d))}else if(f===void 0){var _=n.get(s),v=_==null?void 0:_.v;if(_!==void 0&&v!==M)return{enumerable:!0,configurable:!0,value:v,writable:!0}}return f},has(u,s){var v;if(s===Ge)return!0;var f=n.get(s),d=f!==void 0&&f.v!==M||Reflect.has(u,s);if(f!==void 0||b!==null&&(!d||(v=Ne(u,s))!=null&&v.writable)){f===void 0&&(f=a(()=>{var c=d?ve(u[s]):M,o=F(c);return o}),n.set(s,f));var _=p(f);if(_===M)return!1}return d},set(u,s,f,d){var g;var _=n.get(s),v=s in u;if(r&&s==="length")for(var c=f;c<_.v;c+=1){var o=n.get(c+"");o!==void 0?x(o,M):c in u&&(o=a(()=>F(M)),n.set(c+"",o))}if(_===void 0)(!v||(g=Ne(u,s))!=null&&g.writable)&&(_=a(()=>F(void 0)),x(_,ve(f)),n.set(s,_));else{v=_.v!==M;var h=a(()=>ve(f));x(_,h)}var m=Reflect.getOwnPropertyDescriptor(u,s);if(m!=null&&m.set&&m.set.call(d,f),!v){if(r&&typeof s=="string"){var w=n.get("length"),y=Number(s);Number.isInteger(y)&&y>=w.v&&x(w,y+1)}Kt(i)}return!0},ownKeys(u){p(i);var s=Reflect.ownKeys(u).filter(_=>{var v=n.get(_);return v===void 0||v.v!==M});for(var[f,d]of n)d.v!==M&&!(f in u)&&s.push(f);return s},setPrototypeOf(){Rr()}})}var Yt,Tn,Sn,qn;function Zr(){if(Yt===void 0){Yt=window,Tn=/Firefox/.test(navigator.userAgent);var e=Element.prototype,t=Node.prototype,n=Text.prototype;Sn=Ne(t,"firstChild").get,qn=Ne(t,"nextSibling").get,sn(e)&&(e.__click=void 0,e.__className=void 0,e.__attributes=null,e.__style=void 0,e.__e=void 0),sn(n)&&(n.__t=void 0)}}function $e(e=""){return document.createTextNode(e)}function de(e){return Sn.call(e)}function Et(e){return qn.call(e)}function G(e,t){return de(e)}function te(e,t){{var n=de(e);return n instanceof Comment&&n.data===""?Et(n):n}}function _e(e,t=1,n=!1){let r=e;for(;t--;)r=Et(r);return r}function Jr(e){e.textContent=""}function Pn(){return!1}let Rn=!1;function $r(){Rn||(Rn=!0,document.addEventListener("reset",e=>{Promise.resolve().then(()=>{var t;if(!e.defaultPrevented)for(const n of e.target.elements)(t=n.__on_r)==null||t.call(n)})},{capture:!0}))}function bt(e){var t=E,n=b;ie(null),he(null);try{return e()}finally{ie(t),he(n)}}function el(e,t,n,r=n){e.addEventListener(t,()=>bt(n));const i=e.__on_r;i?e.__on_r=()=>{i(),r(!0)}:e.__on_r=()=>r(!0),$r()}function tl(e){b===null&&E===null&&Sr(),E!==null&&(E.f&z)!==0&&b===null&&Tr(),Se&&xr()}function nl(e,t){var n=t.last;n===null?t.last=t.first=e:(n.next=e,e.prev=n,t.last=e)}function ue(e,t,n,r=!0){var i=b;i!==null&&(i.f&ee)!==0&&(e|=ee);var l={ctx:L,deps:null,nodes_start:null,nodes_end:null,f:e|$,first:null,fn:t,last:null,next:null,parent:i,b:i&&i.b,prev:null,teardown:null,transitions:null,wv:0,ac:null};if(n)try{Ke(l),l.f|=Dt}catch(s){throw re(l),s}else t!==null&&Ue(l);var a=n&&l.deps===null&&l.first===null&&l.nodes_start===null&&l.teardown===null&&(l.f&Mt)===0;if(!a&&r&&(i!==null&&nl(l,i),E!==null&&(E.f&B)!==0&&(e&Ee)===0)){var u=E;(u.effects??(u.effects=[])).push(l)}return l}function rl(e){const t=ue(Ct,null,!1);return V(t,N),t.teardown=e,t}function Bt(e){tl();var t=b.f,n=!E&&(t&se)!==0&&(t&Dt)===0;if(n){var r=L;(r.e??(r.e=[])).push(e)}else return An(e)}function An(e){return ue(At|yr,e,!1)}function ll(e){Ze.ensure();const t=ue(Ee,e,!0);return(n={})=>new Promise(r=>{n.outro?zt(t,()=>{re(t),r(void 0)}):(re(t),r(void 0))})}function il(e){return ue(At,e,!1)}function al(e){return ue(Lt|Mt,e,!0)}function Cn(e,t=0){return ue(Ct|t,e,!0)}function Wt(e,t=[],n=[]){Hr(t,n,r=>{ue(Ct,()=>e(...r.map(p)),!0)})}function Ht(e,t=0){var n=ue(Le|t,e,!0);return n}function Ve(e,t=!0){return ue(se,e,!0,t)}function Dn(e){var t=e.teardown;if(t!==null){const n=Se,r=E;Un(!0),ie(null);try{t.call(null)}finally{Un(n),ie(r)}}}function Mn(e,t=!1){var n=e.first;for(e.first=e.last=null;n!==null;){const i=n.ac;i!==null&&bt(()=>{i.abort(Ft)});var r=n.next;(n.f&Ee)!==0?n.parent=null:re(n,t),n=r}}function sl(e){for(var t=e.first;t!==null;){var n=t.next;(t.f&se)===0&&re(t),t=n}}function re(e,t=!0){var n=!1;(t||(e.f&wr)!==0)&&e.nodes_start!==null&&e.nodes_end!==null&&(Nn(e.nodes_start,e.nodes_end),n=!0),Mn(e,t&&!n),xt(e,0),V(e,be);var r=e.transitions;if(r!==null)for(const l of r)l.stop();Dn(e);var i=e.parent;i!==null&&i.first!==null&&Ln(e),e.next=e.prev=e.teardown=e.ctx=e.deps=e.fn=e.nodes_start=e.nodes_end=e.ac=null}function Nn(e,t){for(;e!==null;){var n=e===t?null:Et(e);e.remove(),e=n}}function Ln(e){var t=e.parent,n=e.prev,r=e.next;n!==null&&(n.next=r),r!==null&&(r.prev=n),t!==null&&(t.first===e&&(t.first=r),t.last===e&&(t.last=n))}function zt(e,t){var n=[];Gt(e,n,!0),Fn(n,()=>{re(e),t&&t()})}function Fn(e,t){var n=e.length;if(n>0){var r=()=>--n||t();for(var i of e)i.out(r)}else t()}function Gt(e,t,n){if((e.f&ee)===0){if(e.f^=ee,e.transitions!==null)for(const a of e.transitions)(a.is_global||n)&&t.push(a);for(var r=e.first;r!==null;){var i=r.next,l=(r.f&ct)!==0||(r.f&se)!==0;Gt(r,t,l?n:!1),r=i}}}function Qt(e){In(e,!0)}function In(e,t){if((e.f&ee)!==0){e.f^=ee,(e.f&N)===0&&(V(e,$),Ue(e));for(var n=e.first;n!==null;){var r=n.next,i=(n.f&ct)!==0||(n.f&se)!==0;In(n,i?t:!1),n=r}if(e.transitions!==null)for(const l of e.transitions)(l.is_global||t)&&l.in()}}let je=!1;function On(e){je=e}let Se=!1;function Un(e){Se=e}let E=null,le=!1;function ie(e){E=e}let b=null;function he(e){b=e}let I=null;function Vn(e){E!==null&&(I===null?I=[e]:I.push(e))}let O=null,W=0,Q=null;function ul(e){Q=e}let jn=1,et=0,qe=et;function Kn(e){qe=e}let pe=!1;function Yn(){return++jn}function kt(e){var _;var t=e.f;if((t&$)!==0)return!0;if((t&fe)!==0){var n=e.deps,r=(t&z)!==0;if(n!==null){var i,l,a=(t&ot)!==0,u=r&&b!==null&&!pe,s=n.length;if((a||u)&&(b===null||(b.f&be)===0)){var f=e,d=f.parent;for(i=0;i<s;i++)l=n[i],(a||!((_=l==null?void 0:l.reactions)!=null&&_.includes(f)))&&(l.reactions??(l.reactions=[])).push(f);a&&(f.f^=ot),u&&d!==null&&(d.f&z)===0&&(f.f^=z)}for(i=0;i<s;i++)if(l=n[i],kt(l)&&mn(l),l.wv>e.wv)return!0}(!r||b!==null&&!pe)&&V(e,N)}return!1}function Bn(e,t,n=!0){var r=e.reactions;if(r!==null&&!(I!=null&&I.includes(e)))for(var i=0;i<r.length;i++){var l=r[i];(l.f&B)!==0?Bn(l,t,!1):t===l&&(n?V(l,$):(l.f&N)!==0&&V(l,fe),Ue(l))}}function Wn(e){var h;var t=O,n=W,r=Q,i=E,l=pe,a=I,u=L,s=le,f=qe,d=e.f;O=null,W=0,Q=null,pe=(d&z)!==0&&(le||!je||E===null),E=(d&(se|Ee))===0?e:null,I=null,dt(e.ctx),le=!1,qe=++et,e.ac!==null&&(bt(()=>{e.ac.abort(Ft)}),e.ac=null);try{e.f|=Nt;var _=e.fn,v=_(),c=e.deps;if(O!==null){var o;if(xt(e,W),c!==null&&W>0)for(c.length=W+O.length,o=0;o<O.length;o++)c[W+o]=O[o];else e.deps=c=O;if(!pe||(d&B)!==0&&e.reactions!==null)for(o=W;o<c.length;o++)((h=c[o]).reactions??(h.reactions=[])).push(e)}else c!==null&&W<c.length&&(xt(e,W),c.length=W);if(Oe()&&Q!==null&&!le&&c!==null&&(e.f&(B|fe|$))===0)for(o=0;o<Q.length;o++)Bn(Q[o],e);return i!==null&&i!==e&&(et++,Q!==null&&(r===null?r=Q:r.push(...Q))),(e.f&ke)!==0&&(e.f^=ke),v}catch(m){return Vr(m)}finally{e.f^=Nt,O=t,W=n,Q=r,E=i,pe=l,I=a,dt(u),le=s,qe=f}}function fl(e,t){let n=t.reactions;if(n!==null){var r=D.call(n,e);if(r!==-1){var i=n.length-1;i===0?n=t.reactions=null:(n[r]=n[i],n.pop())}}n===null&&(t.f&B)!==0&&(O===null||!O.includes(t))&&(V(t,fe),(t.f&(z|ot))===0&&(t.f^=ot),gn(t),xt(t,0))}function xt(e,t){var n=e.deps;if(n!==null)for(var r=t;r<n.length;r++)fl(e,n[r])}function Ke(e){var t=e.f;if((t&be)===0){V(e,N);var n=b,r=je;b=e,je=!0;try{(t&Le)!==0?sl(e):Mn(e),Dn(e);var i=Wn(e);e.teardown=typeof i=="function"?i:null,e.wv=jn;var l}finally{je=r,b=n}}}async function Hn(){await Promise.resolve(),Gr()}function p(e){var t=e.f,n=(t&B)!==0;if(E!==null&&!le){var r=b!==null&&(b.f&be)!==0;if(!r&&!(I!=null&&I.includes(e))){var i=E.deps;if((E.f&Nt)!==0)e.rv<et&&(e.rv=et,O===null&&i!==null&&i[W]===e?W++:O===null?O=[e]:(!pe||!O.includes(e))&&O.push(e));else{(E.deps??(E.deps=[])).push(e);var l=e.reactions;l===null?e.reactions=[E]:l.includes(E)||l.push(E)}}}else if(n&&e.deps===null&&e.effects===null){var a=e,u=a.parent;u!==null&&(u.f&z)===0&&(a.f^=z)}if(Se){if(ce.has(e))return ce.get(e);if(n){a=e;var s=a.v;return((a.f&N)===0&&a.reactions!==null||zn(a))&&(s=Vt(a)),ce.set(a,s),s}}else if(n){if(a=e,oe!=null&&oe.has(a))return oe.get(a);kt(a)&&mn(a)}if((e.f&ke)!==0)throw e.v;return e.v}function zn(e){if(e.v===M)return!0;if(e.deps===null)return!1;for(const t of e.deps)if(ce.has(t)||(t.f&B)!==0&&zn(t))return!0;return!1}function Gn(e){var t=le;try{return le=!0,e()}finally{le=t}}const ol=-7169;function V(e,t){e.f=e.f&ol|t}const cl=["touchstart","touchmove"];function vl(e){return cl.includes(e)}const Qn=new Set,Xt=new Set;function dl(e,t,n,r={}){function i(l){if(r.capture||tt.call(t,l),!l.cancelBubble)return bt(()=>n==null?void 0:n.call(this,l))}return e.startsWith("pointer")||e.startsWith("touch")||e==="wheel"?hn(()=>{t.addEventListener(e,i,r)}):t.addEventListener(e,i,r),i}function Xn(e,t,n,r,i){var l={capture:r,passive:i},a=dl(e,t,n,l);(t===document.body||t===window||t===document||t instanceof HTMLMediaElement)&&rl(()=>{t.removeEventListener(e,a,l)})}function Zt(e){for(var t=0;t<e.length;t++)Qn.add(e[t]);for(var n of Xt)n(e)}let Zn=null;function tt(e){var y;var t=this,n=t.ownerDocument,r=e.type,i=((y=e.composedPath)==null?void 0:y.call(e))||[],l=i[0]||e.target;Zn=e;var a=0,u=Zn===e&&e.__root;if(u){var s=i.indexOf(u);if(s!==-1&&(t===document||t===window)){e.__root=t;return}var f=i.indexOf(t);if(f===-1)return;s<=f&&(a=s)}if(l=i[a]||e.target,l!==t){Rt(e,"currentTarget",{configurable:!0,get(){return l||n}});var d=E,_=b;ie(null),he(null);try{for(var v,c=[];l!==null;){var o=l.assignedSlot||l.parentNode||l.host||null;try{var h=l["__"+r];if(h!=null&&(!l.disabled||e.target===l))if(S(h)){var[m,...w]=h;m.apply(l,[e,...w])}else h.call(l,e)}catch(g){v?c.push(g):v=g}if(e.cancelBubble||o===t||o===null)break;l=o}if(v){for(let g of c)queueMicrotask(()=>{throw g});throw v}}finally{e.__root=t,delete e.currentTarget,ie(d),he(_)}}}function Jn(e){var t=document.createElement("template");return t.innerHTML=e.replaceAll("<!>","<!---->"),t.content}function nt(e,t){var n=b;n.nodes_start===null&&(n.nodes_start=e,n.nodes_end=t)}function j(e,t){var n=(t&Nr)!==0,r=(t&Lr)!==0,i,l=!e.startsWith("<!>");return()=>{i===void 0&&(i=Jn(l?e:"<!>"+e),n||(i=de(i)));var a=r||Tn?document.importNode(i,!0):i.cloneNode(!0);if(n){var u=de(a),s=a.lastChild;nt(u,s)}else nt(a,a);return a}}function $n(e=""){{var t=$e(e+"");return nt(t,t),t}}function ge(){var e=document.createDocumentFragment(),t=document.createComment(""),n=$e();return e.append(t,n),nt(t,n),e}function R(e,t){e!==null&&e.before(t)}function _l(e,t){var n=t==null?"":typeof t=="object"?t+"":t;n!==(e.__t??(e.__t=e.nodeValue))&&(e.__t=n,e.nodeValue=n+"")}function hl(e,t){return pl(e,t)}const Ye=new Map;function pl(e,{target:t,anchor:n,props:r={},events:i,context:l,intro:a=!0}){Zr();var u=new Set,s=_=>{for(var v=0;v<_.length;v++){var c=_[v];if(!u.has(c)){u.add(c);var o=vl(c);t.addEventListener(c,tt,{passive:o});var h=Ye.get(c);h===void 0?(document.addEventListener(c,tt,{passive:o}),Ye.set(c,1)):Ye.set(c,h+1)}}};s(Me(Qn)),Xt.add(s);var f=void 0,d=ll(()=>{var _=n??t.appendChild($e());return Ve(()=>{if(l){Fe({});var v=L;v.c=l}i&&(r.$$events=i),f=e(_,r)||{},l&&Ie()}),()=>{var o;for(var v of u){t.removeEventListener(v,tt);var c=Ye.get(v);--c===0?(document.removeEventListener(v,tt),Ye.delete(v)):Ye.set(v,c)}Xt.delete(s),_!==n&&((o=_.parentNode)==null||o.removeChild(_))}});return gl.set(f,d),f}let gl=new WeakMap;function H(e,t,n=!1){var r=e,i=null,l=null,a=M,u=n?ct:0,s=!1;const f=(c,o=!0)=>{s=!0,v(o,c)};var d=null;function _(){d!==null&&(d.lastChild.remove(),r.before(d),d=null);var c=a?i:l,o=a?l:i;c&&Qt(c),o&&zt(o,()=>{a?l=null:i=null})}const v=(c,o)=>{if(a!==(a=c)){var h=Pn(),m=r;if(h&&(d=document.createDocumentFragment(),d.append(m=$e())),a?i??(i=o&&Ve(()=>o(m))):l??(l=o&&Ve(()=>o(m))),h){var w=q,y=a?i:l,g=a?l:i;y&&w.skipped_effects.delete(y),g&&w.skipped_effects.add(g),w.add_callback(_)}else _()}};Ht(()=>{s=!1,t(f),s||v(null,null)},u)}function er(e,t){return t}function ml(e,t,n){for(var r=e.items,i=[],l=t.length,a=0;a<l;a++)Gt(t[a].e,i,!0);var u=l>0&&i.length===0&&n!==null;if(u){var s=n.parentNode;Jr(s),s.append(n),r.clear(),ae(e,t[0].prev,t[l-1].next)}Fn(i,()=>{for(var f=0;f<l;f++){var d=t[f];u||(r.delete(d.k),ae(e,d.prev,d.next)),re(d.e,!u)}})}function tr(e,t,n,r,i,l=null){var a=e,u={flags:t,items:new Map,first:null},s=null,f=!1,d=new Map,_=pn(()=>{var h=n();return S(h)?h:h==null?[]:Me(h)}),v,c;function o(){wl(c,v,u,d,a,i,t,r,n),l!==null&&(v.length===0?s?Qt(s):s=Ve(()=>l(a)):s!==null&&zt(s,()=>{s=null}))}Ht(()=>{c??(c=b),v=p(_);var h=v.length;if(!(f&&h===0)){f=h===0;var m,w,y,g;if(Pn()){var T=new Set,C=q;for(w=0;w<h;w+=1){y=v[w],g=r(y,w);var U=u.items.get(g)??d.get(g);U?nr(U,y,w):(m=rr(null,u,null,null,y,g,w,i,t,n,!0),d.set(g,m)),T.add(g)}for(const[X,K]of u.items)T.has(X)||C.skipped_effects.add(K.e);C.add_callback(o)}else o();p(_)}})}function wl(e,t,n,r,i,l,a,u,s){var f=t.length,d=n.items,_=n.first,v=_,c,o=null,h=[],m=[],w,y,g,T;for(T=0;T<f;T+=1){if(w=t[T],y=u(w,T),g=d.get(y),g===void 0){var C=r.get(y);if(C!==void 0){r.delete(y),d.set(y,C);var U=o?o.next:v;ae(n,o,C),ae(n,C,U),Jt(C,U,i),o=C}else{var X=v?v.e.nodes_start:i;o=rr(X,n,o,o===null?n.first:o.next,w,y,T,l,a,s)}d.set(y,o),h=[],m=[],v=o.next;continue}if(nr(g,w,T),(g.e.f&ee)!==0&&Qt(g.e),g!==v){if(c!==void 0&&c.has(g)){if(h.length<m.length){var K=m[0],A;o=K.prev;var Z=h[0],ye=h[h.length-1];for(A=0;A<h.length;A+=1)Jt(h[A],K,i);for(A=0;A<m.length;A+=1)c.delete(m[A]);ae(n,Z.prev,ye.next),ae(n,o,Z),ae(n,ye,K),v=K,o=ye,T-=1,h=[],m=[]}else c.delete(g),Jt(g,v,i),ae(n,g.prev,g.next),ae(n,g,o===null?n.first:o.next),ae(n,o,g),o=g;continue}for(h=[],m=[];v!==null&&v.k!==y;)(v.e.f&ee)===0&&(c??(c=new Set)).add(v),m.push(v),v=v.next;if(v===null)continue;g=v}h.push(g),o=g,v=g.next}if(v!==null||c!==void 0){for(var Ae=c===void 0?[]:Me(c);v!==null;)(v.e.f&ee)===0&&Ae.push(v),v=v.next;var Ce=Ae.length;if(Ce>0){var ut=null;ml(n,Ae,ut)}}e.first=n.first&&n.first.e,e.last=o&&o.e;for(var Xl of r.values())re(Xl.e);r.clear()}function nr(e,t,n,r){wt(e.v,t),e.i=n}function rr(e,t,n,r,i,l,a,u,s,f,d){var _=(s&Cr)!==0,v=(s&Mr)===0,c=_?v?Xr(i,!1,!1):Je(i):i,o=(s&Dr)===0?a:Je(a),h={i:o,v:c,k:l,a:null,e:null,prev:n,next:r};try{if(e===null){var m=document.createDocumentFragment();m.append(e=$e())}return h.e=Ve(()=>u(e,c,o,f),Fr),h.e.prev=n&&n.e,h.e.next=r&&r.e,n===null?d||(t.first=h):(n.next=h,n.e.next=h.e),r!==null&&(r.prev=h,r.e.prev=h.e),h}finally{}}function Jt(e,t,n){for(var r=e.next?e.next.e.nodes_start:n,i=t?t.e.nodes_start:n,l=e.e.nodes_start;l!==null&&l!==r;){var a=Et(l);i.before(l),l=a}}function ae(e,t,n){t===null?e.first=n:(t.next=n,t.e.next=n&&n.e),n!==null&&(n.prev=t,n.e.prev=t&&t.e)}function $t(e,t,n=!1,r=!1,i=!1){var l=e,a="";Wt(()=>{var u=b;if(a!==(a=t()??"")&&(u.nodes_start!==null&&(Nn(u.nodes_start,u.nodes_end),u.nodes_start=u.nodes_end=null),a!=="")){var s=a+"";n?s=`<svg>${s}</svg>`:r&&(s=`<math>${s}</math>`);var f=Jn(s);if((n||r)&&(f=de(f)),nt(de(f),f.lastChild),n||r)for(;de(f);)l.before(de(f));else l.before(f)}})}function rt(e,t,...n){var r=e,i=gr,l;Ht(()=>{i!==(i=t())&&(l&&(re(l),l=null),l=Ve(()=>i(r,...n)))},ct)}const lr=[...` 	\n\\r\\f\xA0\\v\\uFEFF`];function yl(e,t,n){var r=""+e;if(n){for(var i in n)if(n[i])r=r?r+" "+i:i;else if(r.length)for(var l=i.length,a=0;(a=r.indexOf(i,a))>=0;){var u=a+l;(a===0||lr.includes(r[a-1]))&&(u===r.length||lr.includes(r[u]))?r=(a===0?"":r.substring(0,a))+r.substring(u+1):a=u}}return r===""?null:r}function El(e,t,n,r,i,l){var a=e.__className;if(a!==n||a===void 0){var u=yl(n,r,l);u==null?e.removeAttribute("class"):e.className=u,e.__className=n}else if(l&&i!==l)for(var s in l){var f=!!l[s];(i==null||f!==!!i[s])&&e.classList.toggle(s,f)}return l}function bl(e,t,n=t){var r=Oe(),i=new WeakSet;el(e,"input",l=>{var a=l?e.defaultValue:e.value;if(a=en(e)?tn(a):a,n(a),q!==null&&i.add(q),r&&a!==(a=t())){var u=e.selectionStart,s=e.selectionEnd;e.value=a??"",s!==null&&(e.selectionStart=u,e.selectionEnd=Math.min(s,e.value.length))}}),Gn(t)==null&&e.value&&(n(en(e)?tn(e.value):e.value),q!==null&&i.add(q)),Cn(()=>{var l=t();if(e===document.activeElement){var a=ht??q;if(i.has(a))return}en(e)&&l===tn(e.value)||e.type==="date"&&!l&&!e.value||l!==e.value&&(e.value=l??"")})}function en(e){var t=e.type;return t==="number"||t==="range"}function tn(e){return e===""?null:+e}function ir(e,t){return e===t||(e==null?void 0:e[Ge])===t}function kl(e={},t,n,r){return il(()=>{var i,l;return Cn(()=>{i=l,l=[],Gn(()=>{e!==n(...l)&&(t(e,...l),i&&ir(n(...i),e)&&t(null,...i))})}),()=>{hn(()=>{l&&ir(n(...l),e)&&t(null,...l)})}}),e}let Tt=!1;function xl(e){var t=Tt;try{return Tt=!1,[e(),Tt]}finally{Tt=t}}function nn(e,t,n,r){var m;var i=r,l=!0,a=()=>(l&&(l=!1,i=r),i),u;{var s=Ge in e||Er in e;u=((m=Ne(e,t))==null?void 0:m.set)??(s&&t in e?w=>e[t]=w:void 0)}var f,d=!1;[f,d]=xl(()=>e[t]);var _;if(_=()=>{var w=e[t];return w===void 0?a():(l=!0,w)},u){var v=e.$$legacy;return(function(w,y){return arguments.length>0?((!y||v||d)&&u(y?_():w),w):_()})}var c=!1,o=_t(()=>(c=!1,_()));p(o);var h=b;return(function(w,y){if(arguments.length>0){const g=y?p(o):ve(w);return x(o,g),c=!0,i!==void 0&&(i=g),w}return Se&&c||(h.f&be)!==0?o.v:p(o)})}const Tl="5";typeof window<"u"&&((cr=window.__svelte??(window.__svelte={})).v??(cr.v=new Set)).add(Tl);function ar(e,t){let n;return(...r)=>{clearTimeout(n),n=setTimeout(()=>{e(...r)},t)}}var Sl=e=>e.stopPropagation(),ql=j(\'<dialog class="sb-modal-box svelte-umhpev"><div class="sb-header"><label for="mini-editor">Search</label> <div class="sb-mini-editor"><input id="mini-editor" placeholder="Search with Silversearch" autocomplete="off" class="svelte-umhpev"/></div></div> <div class="sb-help-text"><!></div> <div class="sb-result-list" style="max-height: 80vh;"><!></div></dialog>\');function sr(e,t){Fe(t,!0);let n=nn(t,"query"),r;Bt(()=>{r.showModal()});function i(){syscall("editor.hidePanel","modal")}var l=ql();Xn("click",Yt,i);var a=G(l);a.__click=[Sl],a.__keydown=function(...c){var o;(o=t.onkeydown)==null||o.apply(this,c)};var u=_e(G(a),2),s=G(u),f=_e(a,2),d=G(f);rt(d,()=>t.helpText);var _=_e(f,2),v=G(_);rt(v,()=>t.resultList),kl(l,c=>r=c,()=>r),Xn("cancel",l,c=>{c.preventDefault(),syscall("editor.hidePanel","modal")}),bl(s,n),R(e,l),Ie()}Zt(["click","keydown"]),Or();var Pl=j(`<div class="silversearch-help svelte-1n3mku8"><p class="svelte-1n3mku8">Add the following to your query to refine the search:</p> <ul class="svelte-1n3mku8"><li>Use <code>path:&quot;Library&quot;</code> to restrict your results\n            to paths which include &quot;Library&quot;</li> <li>Use <code>ext:pdf,jpg</code> or <code>ext:png</code>, or\n            a plain <code>.png</code> to restrict your search to certain filetypes</li> <li>Use <code>&quot;exact expressions&quot;</code> in quotes to further filter\n            the results returned by the query</li> <li>Use <code>-apple -pie</code> to exclude notes containing the words\n            &quot;apple&quot; and &quot;pie&quot;</li></ul></div>`);function ur(e){var t=Pl();R(e,t)}function Rl(e){return e.replace(/[.*+?^${}()|[\\]\\\\]/g,"\\\\$&")}const fr=/(<br>|&lt;|&gt;|&quot;|&#039;)/g;function rn(e,t){const n="silversearch-highlight";if(!t.length)return e;try{return e.split(fr).map(r=>r.match(fr)?r:r.replace(new RegExp(`(${t.map(i=>Rl(i.match)).join("|")})`,"giu"),`<span class="${n}">$1</span>`)).join("")}catch(r){return console.error("[Silversearch] Error in highlightText()",r),e}}var Al=j(\'<span class="silversearch-title svelte-nz7epw"><!></span>\'),Cl=j(\'<span class="silversearch-info svelte-nz7epw"><!></span>\'),Dl=j(\'<div class="sb-name svelte-nz7epw"><!> <!></div>\'),Ml=j(\'<div><!> <div class="sb-description svelte-nz7epw"><!></div></div>\');function or(e,t){var n=Ml();let r;n.__click=function(...s){var f;(f=t.onclick)==null||f.apply(this,s)},n.__mousemove=function(...s){var f;(f=t.onmousemove)==null||f.apply(this,s)};var i=G(n);{var l=s=>{var f=Dl(),d=G(f);{var _=o=>{var h=Al(),m=G(h);rt(m,()=>t.title),R(o,h)};H(d,o=>{t.title&&o(_)})}var v=_e(d,2);{var c=o=>{var h=Cl(),m=G(h);rt(m,()=>t.info),R(o,h)};H(v,o=>{t.info&&o(c)})}R(s,f)};H(i,s=>{(t.title||t.info)&&s(l)})}var a=_e(i,2),u=G(a);rt(u,()=>t.description),Wt(s=>r=El(n,1,"sb-option",null,r,s),[()=>({"silversearch-selected":t.selected})]),R(e,n)}Zt(["click","mousemove"]);function Nl(e,t){Fe(t,!0),or(e,{get onclick(){return t.onclick},get onmousemove(){return t.onmousemove},get selected(){return t.selected},description:r=>{var i=ge(),l=te(i);$t(l,()=>rn(t.excerpt.excerpt,t.matches)),R(r,i)}}),Ie()}var Ll=j("Silversearch found <code>0</code> results for your query",1),Fl=j(\'<div class="silversearch-apology svelte-10gbmf8"><!></div>\');function St(e,t){var n=Fl(),r=G(n);{var i=a=>{var u=Ll();R(a,u)},l=a=>{var u=ge(),s=te(u);{var f=d=>{var _=$n("Searching...");R(d,_)};H(s,d=>{t.type==="searching"&&d(f)},!0)}R(a,u)};H(r,a=>{t.type==="no-results"?a(i):a(l,!1)})}R(e,n)}var Il=j("Press <code>Ctrl-Enter</code> to open in new Tab. Use <code>Tab</code> to switch scope.",1),Ol=j("<!> <!>",1);function Ul(e,t){Fe(t,!0);let n=nn(t,"query"),r=F(null),i=F(!1),l=F(0);Bt(()=>{n()?a():(x(r,null),x(i,!1))});const a=ar(s,0);let u=null;async function s(){x(i,!0),u&&(u.reject("canceled"),u=null),u=Promise.withResolvers();try{x(r,(await Promise.race([syscall("silversearch.search",n(),t.currentPath),u.promise]))[0],!0),u=null,x(l,0),_(),x(i,!1)}catch{}}async function f(v){if(!p(r))return;const c=p(r).excerpts[p(l)].offset;await syscall("editor.navigate",`${p(r).name}@${c}`,!1,v),await syscall("editor.hidePanel","modal")}function d(v){var c;if(v.key==="ArrowUp")yt(l,-1);else if(v.key==="ArrowDown")yt(l);else if(v.key==="Enter")f(v.ctrlKey);else return;v.preventDefault(),x(l,Math.max(0,Math.min((((c=p(r))==null?void 0:c.excerpts.length)??0)-1,p(l))),!0),_()}async function _(){await Hn();const v=document.querySelector(".silversearch-selected");v&&v.scrollIntoView({block:"nearest"})}sr(e,{onkeydown:d,get query(){return n()},set query(o){n(o)},helpText:o=>{var h=Il();R(o,h)},resultList:o=>{var h=Ol(),m=te(h);tr(m,17,()=>{var T;return((T=p(r))==null?void 0:T.excerpts)??[]},er,(T,C,U)=>{const X=Ut(()=>U===p(l));{let K=Ut(()=>{var A;return((A=p(r))==null?void 0:A.matches)??[]});Nl(T,{get excerpt(){return p(C)},get matches(){return p(K)},get selected(){return p(X)},onclick:({ctrlKey:A})=>f(A),onmousemove:()=>x(l,U,!0)})}});var w=_e(m,2);{var y=T=>{St(T,{type:"no-results"})},g=T=>{var C=ge(),U=te(C);{var X=A=>{ur(A)},K=A=>{var Z=ge(),ye=te(Z);{var Ae=Ce=>{St(Ce,{type:"searching"})};H(ye,Ce=>{!p(r)&&p(i)&&Ce(Ae)},!0)}R(A,Z)};H(U,A=>{!p(r)&&!p(i)?A(X):A(K,!1)},!0)}R(T,C)};H(w,T=>{!p(r)&&!p(i)&&n()?T(y):T(g,!1)})}R(o,h)},$$slots:{helpText:!0,resultList:!0}}),Ie()}function Vl(e,t){for(const n of e)if(n.type==="range"&&n.from<=t&&t<=n.to)return n.tail;return""}function jl(e,t){Fe(t,!0),or(e,{get onmousemove(){return t.onmousemove},get onclick(){return t.onclick},get selected(){return t.selected},title:l=>{var a=ge(),u=te(a);$t(u,()=>rn(t.result.name,t.result.matchesName)),R(l,a)},info:l=>{var a=$n();Wt(()=>_l(a,`${t.result.matches.length??""} Matches`)),R(l,a)},description:l=>{var a=ge(),u=te(a);$t(u,()=>rn(t.result.excerpts[0].excerpt,t.result.matches)),R(l,a)}}),Ie()}var Kl=j("Use <code>Tab</code> to switch scope.",1),Yl=j("Press <code>Ctrl-Enter</code> to open in new Tab and <code>Alt-Enter</code> to insert a link. <!>",1),Bl=j("<!> <!>",1);function Wl(e,t){Fe(t,!0);let n=nn(t,"query"),r=F(ve([])),i=F(!1),l=F(0);Bt(()=>{n()?a():(x(r,[],!0),x(i,!1))});const a=ar(s,0);let u=null;async function s(){x(i,!0),u&&(u.reject("canceled"),u=null),u=Promise.withResolvers();try{x(r,await Promise.race([syscall("silversearch.search",n()),u.promise]),!0),u=null,x(l,0),v(),x(i,!1)}catch{}}async function f(c){var w,y;const o=p(r)[p(l)],h=((y=(w=o.matches)==null?void 0:w[0])==null?void 0:y.offset)??0;let m=`@${h}`;o.navigationMap&&(m=Vl(o.navigationMap,h)),await syscall("editor.navigate",`${o.name}${m}`,!1,c),await syscall("editor.hidePanel","modal")}async function d(){const o=`[[${p(r)[p(l)].name}]]`;await syscall("editor.insertAtCursor",o),await syscall("editor.hidePanel","modal")}function _(c){if(c.key==="ArrowUp")yt(l,-1);else if(c.key==="ArrowDown")yt(l);else if(c.key==="Enter")c.altKey?d():f(c.ctrlKey);else return;c.preventDefault(),x(l,Math.max(0,Math.min(p(r).length-1,p(l))),!0),v()}async function v(){await Hn();const c=document.querySelector(".silversearch-selected");c&&c.scrollIntoView({block:"nearest"})}sr(e,{onkeydown:_,get query(){return n()},set query(h){n(h)},helpText:h=>{var m=Yl(),w=_e(te(m),5);{var y=g=>{var T=Kl();R(g,T)};H(w,g=>{t.isDocumentEditor||g(y)})}R(h,m)},resultList:h=>{var m=Bl(),w=te(m);tr(w,17,()=>p(r),er,(C,U,X)=>{const K=Ut(()=>X===p(l));jl(C,{get result(){return p(U)},get selected(){return p(K)},onclick:({ctrlKey:A})=>f(A),onmousemove:()=>x(l,X,!0)})});var y=_e(w,2);{var g=C=>{St(C,{type:"no-results"})},T=C=>{var U=ge(),X=te(U);{var K=Z=>{ur(Z)},A=Z=>{var ye=ge(),Ae=te(ye);{var Ce=ut=>{St(ut,{type:"searching"})};H(Ae,ut=>{!p(r).length&&p(i)&&ut(Ce)},!0)}R(Z,ye)};H(X,Z=>{!p(r).length&&!p(i)?Z(K):Z(A,!1)},!0)}R(C,U)};H(y,C=>{!p(r).length&&!p(i)&&n()?C(g):C(T,!1)})}R(h,m)},$$slots:{helpText:!0,resultList:!0}}),Ie()}function Hl(e,t,n){e.stopPropagation(),e.key==="Tab"&&(t.isDocumentEditor||(x(n,!p(n)),e.preventDefault()))}var zl=j("<div><!></div>");function Gl(e,t){let n=F(ve(t.defaultQuery)),r=F(!0);var i=zl();i.__keydown=[Hl,t,r];var l=G(i);{var a=s=>{Wl(s,{get isDocumentEditor(){return t.isDocumentEditor},get query(){return p(n)},set query(f){x(n,f,!0)}})},u=s=>{Ul(s,{get currentPath(){return t.currentPath},get query(){return p(n)},set query(f){x(n,f,!0)}})};H(l,s=>{p(r)?s(a):s(u,!1)})}R(e,i)}Zt(["keydown"]);async function Ql(){const e=syscall("editor.getCurrentPath"),t=syscall("editor.getCurrentEditor");await Promise.race([new Promise(n=>setTimeout(n,75)),new Promise(n=>{const r=document.querySelector("link#stylesheet");r&&(r.onload=n)})]),hl(Gl,{target:document.querySelector("#container"),props:{defaultQuery:globalThis.DEFAULT_QUERY??"",currentPath:await e,isDocumentEditor:await t!=="page"}})}Ql()})();\n';var Se=`<style>html,body{background:none!important}*{font-family:var(--ui-font)}code{font-family:monospace}.silversearch-highlight{background-color:color-mix(in srgb,var(--editor-highlight-background-color),50% transparent)}dialog.svelte-umhpev{outline:none}#mini-editor.svelte-umhpev{caret-color:var(--editor-caret-color);outline:none;border:none;padding:2px 0 0 3px;line-height:1.4;width:100%;background:none;font-family:var(--ui-font);font-size:1em;color:inherit}.silversearch-help.svelte-1n3mku8{padding:8px;line-height:1.5;color:var(--modal-help-color)}.silversearch-help.svelte-1n3mku8 p:where(.svelte-1n3mku8){margin:0}.silversearch-help.svelte-1n3mku8 ul:where(.svelte-1n3mku8){margin:0;list-style-position:inside;padding-left:15px}.sb-description.svelte-nz7epw{display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:3;line-clamp:3;overflow:hidden}.sb-name.svelte-nz7epw{display:flex;white-space:nowrap;align-items:baseline}.silversearch-info.svelte-nz7epw{font-size:.8rem;margin-left:1ch;color:var(--modal-description-color)}.silversearch-title.svelte-nz7epw{text-overflow:ellipsis;overflow:hidden}.silversearch-selected{background-color:var(--editor-selection-background-color)}.silversearch-apology.svelte-10gbmf8{text-align:center;padding:5px}</style>
<link id="stylesheet" rel="stylesheet" href="/.client/main.css"/>
<div id="container"></div>`;var pr="ENTRIES",on="KEYS",an="VALUES",A="",ne=class{constructor(e,t){let s=e._tree,r=Array.from(s.keys());this.set=e,this._type=t,this._path=r.length>0?[{node:s,keys:r}]:[]}next(){let e=this.dive();return this.backtrack(),e}dive(){if(this._path.length===0)return{done:!0,value:void 0};let{node:e,keys:t}=U(this._path);if(U(t)===A)return{done:!1,value:this.result()};let s=e.get(U(t));return this._path.push({node:s,keys:Array.from(s.keys())}),this.dive()}backtrack(){if(this._path.length===0)return;let e=U(this._path).keys;e.pop(),!(e.length>0)&&(this._path.pop(),this.backtrack())}key(){return this.set._prefix+this._path.map(({keys:e})=>U(e)).filter(e=>e!==A).join("")}value(){return U(this._path).node.get(A)}result(){switch(this._type){case an:return this.value();case on:return this.key();default:return[this.key(),this.value()]}}[Symbol.iterator](){return this}},U=n=>n[n.length-1],Ir=(n,e,t)=>{let s=new Map;if(e===void 0)return s;let r=e.length+1,u=r+t,o=new Uint8Array(u*r).fill(t+1);for(let i=0;i<r;++i)o[i]=i;for(let i=1;i<u;++i)o[i*r]=i;return pn(n,e,t,s,o,1,r,""),s},pn=(n,e,t,s,r,u,o,i)=>{let I=u*o;e:for(let p of n.keys())if(p===A){let l=r[I-1];l<=t&&s.set(i,[n.get(p),l])}else{let l=u;for(let d=0;d<p.length;++d,++l){let m=p[d],T=o*l,h=T-o,y=r[T],x=Math.max(0,l-t-1),g=Math.min(o-1,l+t);for(let k=x;k<g;++k){let _=m!==e[k],q=r[h+k]+ +_,ie=r[h+k+1]+1,D=r[T+k]+1,v=r[T+k+1]=Math.min(q,ie,D);v<y&&(y=v)}if(y>t)continue e}pn(n.get(p),e,t,s,r,l,o,i+p)}},te=class n{constructor(e=new Map,t=""){this._size=void 0,this._tree=e,this._prefix=t}atPrefix(e){if(!e.startsWith(this._prefix))throw new Error("Mismatched prefix");let[t,s]=me(this._tree,e.slice(this._prefix.length));if(t===void 0){let[r,u]=Re(s);for(let o of r.keys())if(o!==A&&o.startsWith(u)){let i=new Map;return i.set(o.slice(u.length),r.get(o)),new n(i,e)}}return new n(t,e)}clear(){this._size=void 0,this._tree.clear()}delete(e){return this._size=void 0,cr(this._tree,e)}entries(){return new ne(this,pr)}forEach(e){for(let[t,s]of this)e(t,s,this)}fuzzyGet(e,t){return Ir(this._tree,e,t)}get(e){let t=Ee(this._tree,e);return t!==void 0?t.get(A):void 0}has(e){let t=Ee(this._tree,e);return t!==void 0&&t.has(A)}keys(){return new ne(this,on)}set(e,t){if(typeof e!="string")throw new Error("key must be a string");return this._size=void 0,Ae(this._tree,e).set(A,t),this}get size(){if(this._size)return this._size;this._size=0;let e=this.entries();for(;!e.next().done;)this._size+=1;return this._size}update(e,t){if(typeof e!="string")throw new Error("key must be a string");this._size=void 0;let s=Ae(this._tree,e);return s.set(A,t(s.get(A))),this}fetch(e,t){if(typeof e!="string")throw new Error("key must be a string");this._size=void 0;let s=Ae(this._tree,e),r=s.get(A);return r===void 0&&s.set(A,r=t()),r}values(){return new ne(this,an)}[Symbol.iterator](){return this.entries()}static from(e){let t=new n;for(let[s,r]of e)t.set(s,r);return t}static fromObject(e){return n.from(Object.entries(e))}},me=(n,e,t=[])=>{if(e.length===0||n==null)return[n,t];for(let s of n.keys())if(s!==A&&e.startsWith(s))return t.push([n,s]),me(n.get(s),e.slice(s.length),t);return t.push([n,e]),me(void 0,"",t)},Ee=(n,e)=>{if(e.length===0||n==null)return n;for(let t of n.keys())if(t!==A&&e.startsWith(t))return Ee(n.get(t),e.slice(t.length))},Ae=(n,e)=>{let t=e.length;e:for(let s=0;n&&s<t;){for(let u of n.keys())if(u!==A&&e[s]===u[0]){let o=Math.min(t-s,u.length),i=1;for(;i<o&&e[s+i]===u[i];)++i;let I=n.get(u);if(i===u.length)n=I;else{let p=new Map;p.set(u.slice(i),I),n.set(e.slice(s,s+i),p),n.delete(u),n=p}s+=i;continue e}let r=new Map;return n.set(e.slice(s),r),r}return n},cr=(n,e)=>{let[t,s]=me(n,e);if(t!==void 0){if(t.delete(A),t.size===0)In(s);else if(t.size===1){let[r,u]=t.entries().next().value;cn(s,r,u)}}},In=n=>{if(n.length===0)return;let[e,t]=Re(n);if(e.delete(t),e.size===0)In(n.slice(0,-1));else if(e.size===1){let[s,r]=e.entries().next().value;s!==A&&cn(n.slice(0,-1),s,r)}},cn=(n,e,t)=>{if(n.length===0)return;let[s,r]=Re(n);s.set(r+e,t),s.delete(r)},Re=n=>n[n.length-1],je="or",mn="and",mr="and_not",G=class n{constructor(e){if(e?.fields==null)throw new Error('MiniSearch: option "fields" must be provided');let t=e.autoVacuum==null||e.autoVacuum===!0?Pe:e.autoVacuum;this._options={...be,...e,autoVacuum:t,searchOptions:{...tn,...e.searchOptions||{}},autoSuggestOptions:{...yr,...e.autoSuggestOptions||{}}},this._index=new te,this._documentCount=0,this._documentIds=new Map,this._idToShortId=new Map,this._fieldIds={},this._fieldLength=new Map,this._avgFieldLength=[],this._nextId=0,this._storedFields=new Map,this._dirtCount=0,this._currentVacuum=null,this._enqueuedVacuum=null,this._enqueuedVacuumConditions=ve,this.addFields(this._options.fields)}add(e){let{extractField:t,tokenize:s,processTerm:r,fields:u,idField:o}=this._options,i=t(e,o);if(i==null)throw new Error(`MiniSearch: document does not have ID field "${o}"`);if(this._idToShortId.has(i))throw new Error(`MiniSearch: duplicate ID ${i}`);let I=this.addDocumentId(i);this.saveStoredFields(I,e);for(let p of u){let l=t(e,p);if(l==null)continue;let d=s(l.toString(),p),m=this._fieldIds[p],T=new Set(d).size;this.addFieldLength(I,m,this._documentCount-1,T);for(let h of d){let y=r(h,p);if(Array.isArray(y))for(let x of y)this.addTerm(m,I,x);else y&&this.addTerm(m,I,y)}}}addAll(e){for(let t of e)this.add(t)}addAllAsync(e,t={}){let{chunkSize:s=10}=t,r={chunk:[],promise:Promise.resolve()},{chunk:u,promise:o}=e.reduce(({chunk:i,promise:I},p,l)=>(i.push(p),(l+1)%s===0?{chunk:[],promise:I.then(()=>new Promise(d=>setTimeout(d,0))).then(()=>this.addAll(i))}:{chunk:i,promise:I}),r);return o.then(()=>this.addAll(u))}remove(e){let{tokenize:t,processTerm:s,extractField:r,fields:u,idField:o}=this._options,i=r(e,o);if(i==null)throw new Error(`MiniSearch: document does not have ID field "${o}"`);let I=this._idToShortId.get(i);if(I==null)throw new Error(`MiniSearch: cannot remove document with ID ${i}: it is not in the index`);for(let p of u){let l=r(e,p);if(l==null)continue;let d=t(l.toString(),p),m=this._fieldIds[p],T=new Set(d).size;this.removeFieldLength(I,m,this._documentCount,T);for(let h of d){let y=s(h,p);if(Array.isArray(y))for(let x of y)this.removeTerm(m,I,x);else y&&this.removeTerm(m,I,y)}}this._storedFields.delete(I),this._documentIds.delete(I),this._idToShortId.delete(i),this._fieldLength.delete(I),this._documentCount-=1}removeAll(e){if(e)for(let t of e)this.remove(t);else{if(arguments.length>0)throw new Error("Expected documents to be present. Omit the argument to remove all documents.");this._index=new te,this._documentCount=0,this._documentIds=new Map,this._idToShortId=new Map,this._fieldLength=new Map,this._avgFieldLength=[],this._storedFields=new Map,this._nextId=0}}discard(e){let t=this._idToShortId.get(e);if(t==null)throw new Error(`MiniSearch: cannot discard document with ID ${e}: it is not in the index`);this._idToShortId.delete(e),this._documentIds.delete(t),this._storedFields.delete(t),(this._fieldLength.get(t)||[]).forEach((s,r)=>{this.removeFieldLength(t,r,this._documentCount,s)}),this._fieldLength.delete(t),this._documentCount-=1,this._dirtCount+=1,this.maybeAutoVacuum()}maybeAutoVacuum(){if(this._options.autoVacuum===!1)return;let{minDirtFactor:e,minDirtCount:t,batchSize:s,batchWait:r}=this._options.autoVacuum;this.conditionalVacuum({batchSize:s,batchWait:r},{minDirtCount:t,minDirtFactor:e})}discardAll(e){let t=this._options.autoVacuum;try{this._options.autoVacuum=!1;for(let s of e)this.discard(s)}finally{this._options.autoVacuum=t}this.maybeAutoVacuum()}replace(e){let{idField:t,extractField:s}=this._options,r=s(e,t);this.discard(r),this.add(e)}vacuum(e={}){return this.conditionalVacuum(e)}conditionalVacuum(e,t){return this._currentVacuum?(this._enqueuedVacuumConditions=this._enqueuedVacuumConditions&&t,this._enqueuedVacuum!=null?this._enqueuedVacuum:(this._enqueuedVacuum=this._currentVacuum.then(()=>{let s=this._enqueuedVacuumConditions;return this._enqueuedVacuumConditions=ve,this.performVacuuming(e,s)}),this._enqueuedVacuum)):this.vacuumConditionsMet(t)===!1?Promise.resolve():(this._currentVacuum=this.performVacuuming(e),this._currentVacuum)}async performVacuuming(e,t){let s=this._dirtCount;if(this.vacuumConditionsMet(t)){let r=e.batchSize||Me.batchSize,u=e.batchWait||Me.batchWait,o=1;for(let[i,I]of this._index){for(let[p,l]of I)for(let[d]of l)this._documentIds.has(d)||(l.size<=1?I.delete(p):l.delete(d));this._index.get(i).size===0&&this._index.delete(i),o%r===0&&await new Promise(p=>setTimeout(p,u)),o+=1}this._dirtCount-=s}await null,this._currentVacuum=this._enqueuedVacuum,this._enqueuedVacuum=null}vacuumConditionsMet(e){if(e==null)return!0;let{minDirtCount:t,minDirtFactor:s}=e;return t=t||Pe.minDirtCount,s=s||Pe.minDirtFactor,this.dirtCount>=t&&this.dirtFactor>=s}get isVacuuming(){return this._currentVacuum!=null}get dirtCount(){return this._dirtCount}get dirtFactor(){return this._dirtCount/(1+this._documentCount+this._dirtCount)}has(e){return this._idToShortId.has(e)}getStoredFields(e){let t=this._idToShortId.get(e);if(t!=null)return this._storedFields.get(t)}search(e,t={}){let{searchOptions:s}=this._options,r={...s,...t},u=this.executeQuery(e,t),o=[];for(let[i,{score:I,terms:p,match:l}]of u){let d=p.length||1,m={id:this._documentIds.get(i),score:I*d,terms:Object.keys(l),queryTerms:p,match:l};Object.assign(m,this._storedFields.get(i)),(r.filter==null||r.filter(m))&&o.push(m)}return e===n.wildcard&&r.boostDocument==null||o.sort(rn),o}autoSuggest(e,t={}){t={...this._options.autoSuggestOptions,...t};let s=new Map;for(let{score:u,terms:o}of this.search(e,t)){let i=o.join(" "),I=s.get(i);I!=null?(I.score+=u,I.count+=1):s.set(i,{score:u,terms:o,count:1})}let r=[];for(let[u,{score:o,terms:i,count:I}]of s)r.push({suggestion:u,terms:i,score:o/I});return r.sort(rn),r}get documentCount(){return this._documentCount}get termCount(){return this._index.size}static loadJSON(e,t){if(t==null)throw new Error("MiniSearch: loadJSON should be given the same options used when serializing the index");return this.loadJS(JSON.parse(e),t)}static async loadJSONAsync(e,t){if(t==null)throw new Error("MiniSearch: loadJSON should be given the same options used when serializing the index");return this.loadJSAsync(JSON.parse(e),t)}static getDefault(e){if(be.hasOwnProperty(e))return Be(be,e);throw new Error(`MiniSearch: unknown option "${e}"`)}static loadJS(e,t){let{index:s,documentIds:r,fieldLength:u,storedFields:o,serializationVersion:i}=e,I=this.instantiateMiniSearch(e,t);I._documentIds=Ie(r),I._fieldLength=Ie(u),I._storedFields=Ie(o);for(let[p,l]of I._documentIds)I._idToShortId.set(l,p);for(let[p,l]of s){let d=new Map;for(let m of Object.keys(l)){let T=l[m];i===1&&(T=T.ds),d.set(parseInt(m,10),Ie(T))}I._index.set(p,d)}return I}static async loadJSAsync(e,t){let{index:s,documentIds:r,fieldLength:u,storedFields:o,serializationVersion:i}=e,I=this.instantiateMiniSearch(e,t);I._documentIds=await ce(r),I._fieldLength=await ce(u),I._storedFields=await ce(o);for(let[l,d]of I._documentIds)I._idToShortId.set(d,l);let p=0;for(let[l,d]of s){let m=new Map;for(let T of Object.keys(d)){let h=d[T];i===1&&(h=h.ds),m.set(parseInt(T,10),await ce(h))}++p%1e3===0&&await fn(0),I._index.set(l,m)}return I}static instantiateMiniSearch(e,t){let{documentCount:s,nextId:r,fieldIds:u,averageFieldLength:o,dirtCount:i,serializationVersion:I}=e;if(I!==1&&I!==2)throw new Error("MiniSearch: cannot deserialize an index created with an incompatible version");let p=new n(t);return p._documentCount=s,p._nextId=r,p._idToShortId=new Map,p._fieldIds=u,p._avgFieldLength=o,p._dirtCount=i||0,p._index=new te,p}executeQuery(e,t={}){if(e===n.wildcard)return this.executeWildcardQuery(t);if(typeof e!="string"){let m={...t,...e,queries:void 0},T=e.queries.map(h=>this.executeQuery(h,m));return this.combineResults(T,m.combineWith)}let{tokenize:s,processTerm:r,searchOptions:u}=this._options,o={tokenize:s,processTerm:r,...u,...t},{tokenize:i,processTerm:I}=o,d=i(e).flatMap(m=>I(m)).filter(m=>!!m).map(Tr(o)).map(m=>this.executeQuerySpec(m,o));return this.combineResults(d,o.combineWith)}executeQuerySpec(e,t){let s={...this._options.searchOptions,...t},r=(s.fields||this._options.fields).reduce((y,x)=>({...y,[x]:Be(s.boost,x)||1}),{}),{boostDocument:u,weights:o,maxFuzzy:i,bm25:I}=s,{fuzzy:p,prefix:l}={...tn.weights,...o},d=this._index.get(e.term),m=this.termResults(e.term,e.term,1,e.termBoost,d,r,u,I),T,h;if(e.prefix&&(T=this._index.atPrefix(e.term)),e.fuzzy){let y=e.fuzzy===!0?.2:e.fuzzy,x=y<1?Math.min(i,Math.round(e.term.length*y)):y;x&&(h=this._index.fuzzyGet(e.term,x))}if(T)for(let[y,x]of T){let g=y.length-e.term.length;if(!g)continue;h?.delete(y);let k=l*y.length/(y.length+.3*g);this.termResults(e.term,y,k,e.termBoost,x,r,u,I,m)}if(h)for(let y of h.keys()){let[x,g]=h.get(y);if(!g)continue;let k=p*y.length/(y.length+g);this.termResults(e.term,y,k,e.termBoost,x,r,u,I,m)}return m}executeWildcardQuery(e){let t=new Map,s={...this._options.searchOptions,...e};for(let[r,u]of this._documentIds){let o=s.boostDocument?s.boostDocument(u,"",this._storedFields.get(r)):1;t.set(r,{score:o,terms:[],match:{}})}return t}combineResults(e,t=je){if(e.length===0)return new Map;let s=t.toLowerCase(),r=fr[s];if(!r)throw new Error(`Invalid combination operator: ${t}`);return e.reduce(r)||new Map}toJSON(){let e=[];for(let[t,s]of this._index){let r={};for(let[u,o]of s)r[u]=Object.fromEntries(o);e.push([t,r])}return{documentCount:this._documentCount,nextId:this._nextId,documentIds:Object.fromEntries(this._documentIds),fieldIds:this._fieldIds,fieldLength:Object.fromEntries(this._fieldLength),averageFieldLength:this._avgFieldLength,storedFields:Object.fromEntries(this._storedFields),dirtCount:this._dirtCount,index:e,serializationVersion:2}}termResults(e,t,s,r,u,o,i,I,p=new Map){if(u==null)return p;for(let l of Object.keys(o)){let d=o[l],m=this._fieldIds[l],T=u.get(m);if(T==null)continue;let h=T.size,y=this._avgFieldLength[m];for(let x of T.keys()){if(!this._documentIds.has(x)){this.removeTerm(m,x,t),h-=1;continue}let g=i?i(this._documentIds.get(x),t,this._storedFields.get(x)):1;if(!g)continue;let k=T.get(x),_=this._fieldLength.get(x)[m],q=lr(k,h,this._documentCount,_,y,I),ie=s*r*d*g*q,D=p.get(x);if(D){D.score+=ie,hr(D.terms,e);let v=Be(D.match,t);v?v.push(l):D.match[t]=[l]}else p.set(x,{score:ie,terms:[e],match:{[t]:[l]}})}}return p}addTerm(e,t,s){let r=this._index.fetch(s,un),u=r.get(e);if(u==null)u=new Map,u.set(t,1),r.set(e,u);else{let o=u.get(t);u.set(t,(o||0)+1)}}removeTerm(e,t,s){if(!this._index.has(s)){this.warnDocumentChanged(t,e,s);return}let r=this._index.fetch(s,un),u=r.get(e);u==null||u.get(t)==null?this.warnDocumentChanged(t,e,s):u.get(t)<=1?u.size<=1?r.delete(e):u.delete(t):u.set(t,u.get(t)-1),this._index.get(s).size===0&&this._index.delete(s)}warnDocumentChanged(e,t,s){for(let r of Object.keys(this._fieldIds))if(this._fieldIds[r]===t){this._options.logger("warn",`MiniSearch: document with ID ${this._documentIds.get(e)} has changed before removal: term "${s}" was not present in field "${r}". Removing a document after it has changed can corrupt the index!`,"version_conflict");return}}addDocumentId(e){let t=this._nextId;return this._idToShortId.set(e,t),this._documentIds.set(t,e),this._documentCount+=1,this._nextId+=1,t}addFields(e){for(let t=0;t<e.length;t++)this._fieldIds[e[t]]=t}addFieldLength(e,t,s,r){let u=this._fieldLength.get(e);u==null&&this._fieldLength.set(e,u=[]),u[t]=r;let i=(this._avgFieldLength[t]||0)*s+r;this._avgFieldLength[t]=i/(s+1)}removeFieldLength(e,t,s,r){if(s===1){this._avgFieldLength[t]=0;return}let u=this._avgFieldLength[t]*s-r;this._avgFieldLength[t]=u/(s-1)}saveStoredFields(e,t){let{storeFields:s,extractField:r}=this._options;if(s==null||s.length===0)return;let u=this._storedFields.get(e);u==null&&this._storedFields.set(e,u={});for(let o of s){let i=r(t,o);i!==void 0&&(u[o]=i)}}};G.wildcard=Symbol("*");var Be=(n,e)=>Object.prototype.hasOwnProperty.call(n,e)?n[e]:void 0,fr={[je]:(n,e)=>{for(let t of e.keys()){let s=n.get(t);if(s==null)n.set(t,e.get(t));else{let{score:r,terms:u,match:o}=e.get(t);s.score=s.score+r,s.match=Object.assign(s.match,o),sn(s.terms,u)}}return n},[mn]:(n,e)=>{let t=new Map;for(let s of e.keys()){let r=n.get(s);if(r==null)continue;let{score:u,terms:o,match:i}=e.get(s);sn(r.terms,o),t.set(s,{score:r.score+u,terms:r.terms,match:Object.assign(r.match,i)})}return t},[mr]:(n,e)=>{for(let t of e.keys())n.delete(t);return n}},dr={k:1.2,b:.7,d:.5},lr=(n,e,t,s,r,u)=>{let{k:o,b:i,d:I}=u;return Math.log(1+(t-e+.5)/(e+.5))*(I+n*(o+1)/(n+o*(1-i+i*s/r)))},Tr=n=>(e,t,s)=>{let r=typeof n.fuzzy=="function"?n.fuzzy(e,t,s):n.fuzzy||!1,u=typeof n.prefix=="function"?n.prefix(e,t,s):n.prefix===!0,o=typeof n.boostTerm=="function"?n.boostTerm(e,t,s):1;return{term:e,fuzzy:r,prefix:u,termBoost:o}},be={idField:"id",extractField:(n,e)=>n[e],tokenize:n=>n.split(xr),processTerm:n=>n.toLowerCase(),fields:void 0,searchOptions:void 0,storeFields:[],logger:(n,e)=>{typeof console?.[n]=="function"&&console[n](e)},autoVacuum:!0},tn={combineWith:je,prefix:!1,fuzzy:!1,maxFuzzy:6,boost:{},weights:{fuzzy:.45,prefix:.375},bm25:dr},yr={combineWith:mn,prefix:(n,e,t)=>e===t.length-1},Me={batchSize:1e3,batchWait:10},ve={minDirtFactor:.1,minDirtCount:20},Pe={...Me,...ve},hr=(n,e)=>{n.includes(e)||n.push(e)},sn=(n,e)=>{for(let t of e)n.includes(t)||n.push(t)},rn=({score:n},{score:e})=>e-n,un=()=>new Map,Ie=n=>{let e=new Map;for(let t of Object.keys(n))e.set(parseInt(t,10),n[t]);return e},ce=async n=>{let e=new Map,t=0;for(let s of Object.keys(n))e.set(parseInt(s,10),n[s]),++t%1e3===0&&await fn(0);return e},fn=n=>new Promise(e=>setTimeout(e,n)),xr=/[\n\r\p{Z}\p{P}]+/u;var _e;function W(n){return{lang:n?.lang??_e?.lang,message:n?.message,abortEarly:n?.abortEarly??_e?.abortEarly,abortPipeEarly:n?.abortPipeEarly??_e?.abortPipeEarly}}var gr;function dn(n){return gr?.get(n)}var kr;function ln(n){return kr?.get(n)}var wr;function Tn(n,e){return wr?.get(n)?.get(e)}function S(n){let e=typeof n;return e==="string"?`"${n}"`:e==="number"||e==="bigint"||e==="boolean"?`${n}`:e==="object"||e==="function"?(n&&Object.getPrototypeOf(n)?.constructor?.name)??"null":e}function a(n,e,t,s,r){let u=r&&"input"in r?r.input:t.value,o=r?.expected??n.expects??null,i=r?.received??S(u),I={kind:n.kind,type:n.type,input:u,expected:o,received:i,message:`Invalid ${e}: ${o?`Expected ${o} but r`:"R"}eceived ${i}`,requirement:n.requirement,path:r?.path,issues:r?.issues,lang:s.lang,abortEarly:s.abortEarly,abortPipeEarly:s.abortPipeEarly},p=n.kind==="schema",l=r?.message??n.message??Tn(n.reference,I.lang)??(p?ln(I.lang):null)??s.message??dn(I.lang);l!==void 0&&(I.message=typeof l=="function"?l(I):l),p&&(t.typed=!1),t.issues?t.issues.push(I):t.issues=[I]}function f(n){return{version:1,vendor:"valibot",validate(e){return n["~run"]({value:e},W())}}}function L(n,e){return Object.hasOwn(n,e)&&e!=="__proto__"&&e!=="prototype"&&e!=="constructor"}function E(n,e){let t=[...new Set(n)];return t.length>1?`(${t.join(` ${e} `)})`:t[0]??"never"}function qe(n){if(n.path){let e="";for(let t of n.path)if(typeof t.key=="string"||typeof t.key=="number")e?e+=`.${t.key}`:e+=t.key;else return null;return e}return null}var j=class extends Error{issues;constructor(e){super(e[0].message),this.name="ValiError",this.issues=e}};function P(n,e,t){return typeof n.fallback=="function"?n.fallback(e,t):n.fallback}function yn(n){let e={};for(let t of n)if(t.path){let s=qe(t);s?(e.nested||(e.nested={}),e.nested[s]?e.nested[s].push(t.message):e.nested[s]=[t.message]):e.other?e.other.push(t.message):e.other=[t.message]}else e.root?e.root.push(t.message):e.root=[t.message];return e}function O(n,e,t){return typeof n.default=="function"?n.default(e,t):n.default}function se(n,e){return{kind:"schema",type:"array",reference:se,expects:"Array",async:!1,item:n,message:e,get"~standard"(){return f(this)},"~run"(t,s){let r=t.value;if(Array.isArray(r)){t.typed=!0,t.value=[];for(let u=0;u<r.length;u++){let o=r[u],i=this.item["~run"]({value:o},s);if(i.issues){let I={type:"array",origin:"value",input:r,key:u,value:o};for(let p of i.issues)p.path?p.path.unshift(I):p.path=[I],t.issues?.push(p);if(t.issues||(t.issues=i.issues),s.abortEarly){t.typed=!1;break}}i.typed||(t.typed=!1),t.value.push(i.value)}}else a(this,"type",t,s);return t}}}function F(n){return{kind:"schema",type:"boolean",reference:F,expects:"boolean",async:!1,message:n,get"~standard"(){return f(this)},"~run"(e,t){return typeof e.value=="boolean"?e.typed=!0:a(this,"type",e,t),e}}}function Ve(n,e){let t=[];for(let s in n)(`${+s}`!==s||typeof n[s]!="string"||!Object.is(n[n[s]],+s))&&t.push(n[s]);return{kind:"schema",type:"enum",reference:Ve,expects:E(t.map(S),"|"),async:!1,enum:n,options:t,message:e,get"~standard"(){return f(this)},"~run"(s,r){return this.options.includes(s.value)?s.typed=!0:a(this,"type",s,r),s}}}function Ne(n,e){return{kind:"schema",type:"literal",reference:Ne,expects:S(n),async:!1,literal:n,message:e,get"~standard"(){return f(this)},"~run"(t,s){return t.value===this.literal?t.typed=!0:a(this,"type",t,s),t}}}function M(n){return{kind:"schema",type:"number",reference:M,expects:"number",async:!1,message:n,get"~standard"(){return f(this)},"~run"(e,t){return typeof e.value=="number"&&!isNaN(e.value)?e.typed=!0:a(this,"type",e,t),e}}}function Le(n,e){return{kind:"schema",type:"object",reference:Le,expects:"Object",async:!1,entries:n,message:e,get"~standard"(){return f(this)},"~run"(t,s){let r=t.value;if(r&&typeof r=="object"){t.typed=!0,t.value={};for(let u in this.entries){let o=this.entries[u];if(u in r||(o.type==="exact_optional"||o.type==="optional"||o.type==="nullish")&&o.default!==void 0){let i=u in r?r[u]:O(o),I=o["~run"]({value:i},s);if(I.issues){let p={type:"object",origin:"value",input:r,key:u,value:i};for(let l of I.issues)l.path?l.path.unshift(p):l.path=[p],t.issues?.push(l);if(t.issues||(t.issues=I.issues),s.abortEarly){t.typed=!1;break}}I.typed||(t.typed=!1),t.value[u]=I.value}else if(o.fallback!==void 0)t.value[u]=P(o);else if(o.type!=="exact_optional"&&o.type!=="optional"&&o.type!=="nullish"&&(a(this,"key",t,s,{input:void 0,expected:`"${u}"`,path:[{type:"object",origin:"key",input:r,key:u,value:r[u]}]}),s.abortEarly))break}}else a(this,"type",t,s);return t}}}function w(n,e){return{kind:"schema",type:"optional",reference:w,expects:`(${n.expects} | undefined)`,async:!1,wrapped:n,default:e,get"~standard"(){return f(this)},"~run"(t,s){return t.value===void 0&&(this.default!==void 0&&(t.value=O(this,t,s)),t.value===void 0)?(t.typed=!0,t):this.wrapped["~run"](t,s)}}}function J(n,e){return{kind:"schema",type:"picklist",reference:J,expects:E(n.map(S),"|"),async:!1,options:n,message:e,get"~standard"(){return f(this)},"~run"(t,s){return this.options.includes(t.value)?t.typed=!0:a(this,"type",t,s),t}}}function Fe(n,e,t){return{kind:"schema",type:"record",reference:Fe,expects:"Object",async:!1,key:n,value:e,message:t,get"~standard"(){return f(this)},"~run"(s,r){let u=s.value;if(u&&typeof u=="object"){s.typed=!0,s.value={};for(let o in u)if(L(u,o)){let i=u[o],I=this.key["~run"]({value:o},r);if(I.issues){let l={type:"object",origin:"key",input:u,key:o,value:i};for(let d of I.issues)d.path=[l],s.issues?.push(d);if(s.issues||(s.issues=I.issues),r.abortEarly){s.typed=!1;break}}let p=this.value["~run"]({value:i},r);if(p.issues){let l={type:"object",origin:"value",input:u,key:o,value:i};for(let d of p.issues)d.path?d.path.unshift(l):d.path=[l],s.issues?.push(d);if(s.issues||(s.issues=p.issues),r.abortEarly){s.typed=!1;break}}(!I.typed||!p.typed)&&(s.typed=!1),I.typed&&(s.value[I.value]=p.value)}}else a(this,"type",s,r);return s}}}function H(n,e){return{kind:"schema",type:"strict_object",reference:H,expects:"Object",async:!1,entries:n,message:e,get"~standard"(){return f(this)},"~run"(t,s){let r=t.value;if(r&&typeof r=="object"){t.typed=!0,t.value={};for(let u in this.entries){let o=this.entries[u];if(u in r||(o.type==="exact_optional"||o.type==="optional"||o.type==="nullish")&&o.default!==void 0){let i=u in r?r[u]:O(o),I=o["~run"]({value:i},s);if(I.issues){let p={type:"object",origin:"value",input:r,key:u,value:i};for(let l of I.issues)l.path?l.path.unshift(p):l.path=[p],t.issues?.push(l);if(t.issues||(t.issues=I.issues),s.abortEarly){t.typed=!1;break}}I.typed||(t.typed=!1),t.value[u]=I.value}else if(o.fallback!==void 0)t.value[u]=P(o);else if(o.type!=="exact_optional"&&o.type!=="optional"&&o.type!=="nullish"&&(a(this,"key",t,s,{input:void 0,expected:`"${u}"`,path:[{type:"object",origin:"key",input:r,key:u,value:r[u]}]}),s.abortEarly))break}if(!t.issues||!s.abortEarly){for(let u in r)if(!(u in this.entries)){a(this,"key",t,s,{input:u,expected:"never",path:[{type:"object",origin:"key",input:r,key:u,value:r[u]}]});break}}}else a(this,"type",t,s);return t}}}function K(n){return{kind:"schema",type:"string",reference:K,expects:"string",async:!1,message:n,get"~standard"(){return f(this)},"~run"(e,t){return typeof e.value=="string"?e.typed=!0:a(this,"type",e,t),e}}}function fe(n,e,t){let s=n["~run"]({value:e},W(t));if(s.issues)throw new j(s.issues);return s.value}function re(n,e,t){let s=n["~run"]({value:e},W(t));return{typed:s.typed,success:!s.issues,output:s.value,issues:s.issues}}var xn=100,ue=300,de=(r=>(r.Disabled="disabled",r.Day="day",r.Week="week",r.Month="month",r))(de||{}),Pr='/[|\\t\\n\\r\\^"= -#%-*,.`\\/<>:;?@[-\\]_{}\\u00A0\\u00A1\\u00A7\\u00AB\\u00B6\\u00B7\\u00BB\\u00BF\\u037E\\u0387\\u055A-\\u055F\\u0589\\u058A\\u05BE\\u05C0\\u05C3\\u05C6\\u05F3\\u05F4\\u0609\\u060A\\u060C\\u060D\\u061B\\u061E\\u061F\\u066A-\\u066D\\u06D4\\u0700-\\u070D\\u07F7-\\u07F9\\u0830-\\u083E\\u085E\\u0964\\u0965\\u0970\\u09FD\\u0A76\\u0AF0\\u0C77\\u0C84\\u0DF4\\u0E4F\\u0E5A\\u0E5B\\u0F04-\\u0F12\\u0F14\\u0F3A-\\u0F3D\\u0F85\\u0FD0-\\u0FD4\\u0FD9\\u0FDA\\u104A-\\u104F\\u10FB\\u1360-\\u1368\\u1400\\u166E\\u1680\\u169B\\u169C\\u16EB-\\u16ED\\u1735\\u1736\\u17D4-\\u17D6\\u17D8-\\u17DA\\u1800-\\u180A\\u1944\\u1945\\u1A1E\\u1A1F\\u1AA0-\\u1AA6\\u1AA8-\\u1AAD\\u1B5A-\\u1B60\\u1BFC-\\u1BFF\\u1C3B-\\u1C3F\\u1C7E\\u1C7F\\u1CC0-\\u1CC7\\u1CD3\\u2000-\\u200A\\u2010-\\u2029\\u202F-\\u2043\\u2045-\\u2051\\u2053-\\u205F\\u207D\\u207E\\u208D\\u208E\\u2308-\\u230B\\u2329\\u232A\\u2768-\\u2775\\u27C5\\u27C6\\u27E6-\\u27EF\\u2983-\\u2998\\u29D8-\\u29DB\\u29FC\\u29FD\\u2CF9-\\u2CFC\\u2CFE\\u2CFF\\u2D70\\u2E00-\\u2E2E\\u2E30-\\u2E4F\\u3000-\\u3003\\u3008-\\u3011\\u3014-\\u301F\\u3030\\u303D\\u30A0\\u30FB\\uA4FE\\uA4FF\\uA60D-\\uA60F\\uA673\\uA67E\\uA6F2-\\uA6F7\\uA874-\\uA877\\uA8CE\\uA8CF\\uA8F8-\\uA8FA\\uA8FC\\uA92E\\uA92F\\uA95F\\uA9C1-\\uA9CD\\uA9DE\\uA9DF\\uAA5C-\\uAA5F\\uAADE\\uAADF\\uAAF0\\uAAF1\\uABEB\\uFD3E\\uFD3F\\uFE10-\\uFE19\\uFE30-\\uFE52\\uFE54-\\uFE61\\uFE63\\uFE68\\uFE6A\\uFE6B\\uFF01-\\uFF03\\uFF05-\\uFF0A\\uFF0C-\\uFF0F\\uFF1A\\uFF1B\\uFF1F\\uFF20\\uFF3B-\\uFF3D\\uFF3F\\uFF5B\\uFF5D\\uFF5F-\\uFF65]/'.slice(1,-1),gn=new RegExp(`${Pr}+`,"u"),kn=/[|\[\]\(\)<>\{\} \t\n\r]/u;var wn=!1,oe=null,On=H({content:w(M(),1),basename:w(M(),10),displayName:w(M(),10),directory:w(M(),7),aliases:w(M(),1),tags:w(M(),1)}),Sn=H({weights:w(On,fe(On,{})),weightCustomProperties:w(Fe(K(),M()),{}),recencyBoost:w(Ve(de),"disabled"),downrankedFoldersFilters:w(se(K()),[]),ignoreDiacritics:w(F(),!0),ignoreArabicDiacritics:w(F(),!1),tokenizeUrls:w(F(),!0),splitCamelCase:w(F(),!0),fuzziness:w(J(["0","1","2"]),"1"),renderLineReturnInExcerpts:w(F(),!0)});async function V(){if(oe)return oe;let n=await ae.getConfig("silversearch",{}),e=re(Sn,n);if(e.success)oe=e.output;else{if(!wn){let t=Object.entries(yn(e.issues).nested??{}).map(([s,r])=>r?`${r.join(" & ")} in "${s}"`:"").filter(s=>s).join("; ");await B.flashNotification(`Silersearch - There was an error in your CONFIG: ${t}`),wn=!0}oe=fe(Sn,{})}return oe}async function An(){return await B.getUiOption("customStyles")}var Er=["\\u30FC","\\u309A","\\u3099"],Mr=Er.join("|"),Bn=new RegExp(`(?!${Mr})\\p{Diacritic}`,"gu");function bn(n){return n.replace(/(\*|_)+(.+?)(\*|_)+/g,(e,t,s)=>s)}function Ke(n){return/[a-z][A-Z]/.test(n)?n.replace(/([a-z](?=[A-Z]))/g,"$1 ").split(" ").filter(t=>t):[]}function $e(n){return n.includes("-")?n.split("-").filter(e=>e):[]}function N(n,e=!1){if(n==null)return"";if(e){n=n.replace(/([^\u0621-\u063A\u0641-\u064A\u0660-\u0669a-zA-Z 0-9])/g,"").replace(/(||)/g,"\u0627").replace(/()/g,"\u0647").replace(/(|)/g,"\u0621").replace(/()/g,"\u064A");for(let t=0;t<10;t++)n.replace(String.fromCharCode(1632+t),String.fromCharCode(48+t))}return n=n.replaceAll("`","[__silversearch__backtick__]"),n=n.replaceAll("^","[__silversearch__caret__]"),n=n.normalize("NFD").replace(Bn,"").normalize("NFC"),n=n.replaceAll("[__silversearch__backtick__]","`"),n=n.replaceAll("[__silversearch__caret__]","^"),n}function Pn(n){return n.replace(new RegExp(`(?!\\^|\`)${Bn.source}`,"gu"),"")}function En(n){let e=[],t=-1,s=0;for(;++s<100;){let r=vr(n,t,ue);if(!r.length)break;t=r.at(-1).offset,e.push(r)}return e}function vr(n,e,t){let s=n.find(r=>r.offset>e);return s?n.filter(r=>r.offset>e&&r.offset<=s.offset+t):[]}var Ue=Qe(Cn());function Wn(n,e){try{let t=Nn(n),s=[];if(e.tokenizeUrls)try{s=(0,Ue.extractMdLinks)(n).map(u=>u.href)}catch(u){console.log("[Silversearch] Error extracting urls",u)}let r=Ln(n,{skipChs:!0});return r=[...r.flatMap(u=>[u,...$e(u),...Ke(u)]),...t],s.length&&(r=[...r,...s]),r=[...new Set(r)],r}catch(t){return console.error("[Silversearch] Error tokenizing text, skipping document",t),[]}}function Vn(n){let e=(0,Ue.extractMdLinks)(n).map(s=>s.href);n=e.reduce((s,r)=>s.replace(r,""),n);let t=[...Ln(n),...e].filter(Boolean);return{combineWith:"OR",queries:[{combineWith:"AND",queries:t},{combineWith:"AND",queries:Nn(n).filter(Boolean)},{combineWith:"AND",queries:t.flatMap($e)},{combineWith:"AND",queries:t.flatMap(Ke)}]}}function Nn(n,{skipChs:e=!1}={}){let t=n.split(kn);return e?t:t}function Ln(n,{skipChs:e=!1}={}){let t=n.split(gn);return e?t:t}function Fn(n){return n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function Fr(n){if(!n.length)return/^$/g;n.sort((t,s)=>s.length-t.length);let e=`(${n.map(t=>`\\b${Fn(t)}\\b|${Fn(t)}`).join("|")})`;return new RegExp(`${e}`,"gui")}async function Ge(n,e,t){let s=await V();e=e.map(Kn);let r=Fr(e),u=n;s.ignoreDiacritics&&(n=N(n,s.ignoreArabicDiacritics));let o=new Date().getTime(),i=null,I=[],p=0;for(;(i=r.exec(n))!==null&&!(++p>=100||new Date().getTime()-o>50);){let l=i.index,d=l+i[0].length,m=u.substring(l,d).trim();m&&i.index>=0&&I.push({match:m,offset:i.index})}if(t&&(t.query.text.length>1||t.getExactTerms().length>0)){let l=n.indexOf(t.getBestStringForExcerpt());l>-1&&I.find(d=>d.offset===l)&&I.unshift({offset:l,match:t.getBestStringForExcerpt()})}return I}async function Je(n,e){let t=await V();try{let s=e??-1,r=Math.max(0,s-xn),u=Math.min(n.length,s+ue);if(s>-1?n=(r>0?"\u2026":"")+n.slice(r,u).trim()+(u<n.length-1?"\u2026":""):n=n.slice(0,ue),t.renderLineReturnInExcerpts){let o=new RegExp(/(?:\r\n|\r|\n)/g);n=n.split(o).filter(I=>I).join(`
`);let i=n.lastIndexOf(`
`,s-r);i>0&&(n=n.slice(i))}return n=Kn(n),t.renderLineReturnInExcerpts&&(n=n.trim().replaceAll(`
`,"<br>")),{excerpt:n,offset:e}}catch(s){return await B.flashNotification("Silversearch - Error while creating excerpt, see developer console","error"),console.error("[Silversearch] Error while creating excerpt",s),{excerpt:"",offset:0}}}function Kn(n){return n.replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;").replaceAll('"',"&quot;").replaceAll("'","&#039;")}function Kr(n){return n!==""?n.split(".").pop().toLowerCase():"md"}function C(n){return $r({path:n})}function X(n){return Kr(n)==="md"}function $r(n){let e=n.path;return X(n.path)&&(e=e.slice(0,-3)),n.details?.type==="linecolumn"?(e+=`@L${n.details.line}`,n.details.column!==1&&(e+=`C${n.details.column}`)):n.details?.type==="position"?e+=`@${n.details.pos}`:n.details?.type==="header"&&(e+=`#${n.details.header}`),e}function $n(n){return n.split("/").slice(0,-1).join("/")}function zn(n){return n.split("/").pop()}var zr=H({content:K(),cacheMode:w(J(["persistent","session"]),"session"),navigationMap:w(se(Le({type:Ne("range"),from:M(),to:M(),tail:K()})))});async function Un(n,e){if(X(n))try{return{content:await R.readPage(C(n)),cacheMode:"session"}}catch{return null}else{let t;try{t=e??await R.getDocumentMeta(C(n))}catch{return null}let s;try{s=await pe.dispatchEvent("silversearch:index",{meta:t})}catch{return console.log("[silversearch] Eventhandler threw error. Discarding it."),null}if(s.length===0)return null;s.length>1&&console.log(`[silversearch] We got multiple responses while indexing ${t.name}. Can't handle that.`);let r=re(zr,s[0]);return r.success?r.output:(console.log("[silversearch] Eventhandler didn't return well-formed result. Discarding it."),null)}}var Gn=4,Q=class n{minisearch;entryCache;constructor(e){this.minisearch=new G(n.getOptions(e)),this.entryCache=new Map}static async loadFromCache(e){let t=await z.get("silversearch-cache");if(!t||t.version!==Gn||typeof t.minisearch!="string"||typeof t.entries!="object")return console.log("[Silversearch] Couldn't find cache or cache version mismatched"),n.deleteCache(),null;let s=new n(e);return s.minisearch=await G.loadJSONAsync(t.minisearch,n.getOptions(e)),s.entryCache=new Map(t.entries),s}static async deleteCache(){await z.del("silversearch-cache")}async writeToCache(){await z.set("silversearch-cache",{version:Gn,minisearch:JSON.stringify(this.minisearch),entries:Array.from(this.entryCache.entries()).filter(e=>e[1].cacheMode==="persistent")})}async reindex(){await B.flashNotification("Silversearch - Reindexing, this can cause performance problems"),this.minisearch.removeAll();let e=(await R.listFiles()).map(t=>t.name).filter(this.isIndexedPath);console.log(`[Silversearch] Indexing ${e.length} pages`),await B.showProgress(0,"index"),await this.indexByPaths(e,(t,s)=>{B.showProgress(Math.round(t/s*100),"index")}),await B.showProgress(),await B.flashNotification("Silversearch - Full reindex done!")}async indexByPath(e){await this.indexByPaths([e])}async indexByPaths(e,t){let s=0;for(let r of e)try{console.log(`[Silversearch] Indexing ${C(r)}`),this.entryCache.delete(r);let u=await this.getCacheEntry(r);if(!u)throw null;this.minisearch.has(u.path)?this.minisearch.replace(u):this.minisearch.add(u),t&&t(++s,e.length)}catch{console.log(`[Silversearch] Failed to index ${C(r)}. Skipping!`)}await this.writeToCache()}async deleteByPath(e){await this.deleteByPaths([e])}async deleteByPaths(e){for(let t of e)try{this.minisearch.discard(t)}catch{console.log("[Silversearch] Something went wrong. Failed to delete page")}await this.writeToCache()}async search(e,t){let s=await V();if(e.isEmpty())return[];let r={0:0,1:.1,2:.2}[s.fuzziness],u=Vn(e.segmentsToStr()),o=this.minisearch.search(u,{prefix:d=>d.length>=t.prefixLength,fuzzy:d=>d.length<=3?0:d.length<=5?r/2:r,boost:{basename:s.weights.basename,aliases:s.weights.aliases,displayName:s.weights.displayName,directory:s.weights.directory,tags:s.weights.tags,unmarkedTags:s.weights.tags},tokenize:d=>[d],boostDocument(d,m,T){if(!T?.lastModified||s.recencyBoost==="disabled")return 1;let h=T?.lastModified,x=(new Date().getTime()-h)/(24*3600*1e3),g={day:-3,week:-.3,month:-.1};return 1+Math.exp(g[s.recencyBoost]*(x/1e3))}});if(e.query.ext?.length&&(o=o.filter(d=>{let m=d.id.includes(".")?"."+d.id.split(".").pop():".md";return e.query.ext?.some(T=>m.startsWith(T.startsWith(".")?T:"."+T))})),e.query.path&&(o=o.filter(d=>e.query.path?.some(m=>d.id.toLowerCase().includes(m.toLowerCase())))),e.query.exclude.path&&(o=o.filter(d=>!e.query.exclude.path?.some(m=>d.id.toLowerCase().includes(m.toLowerCase())))),!o.length)return[];if(t.singleFilePath)return o.filter(d=>d.id===t.singleFilePath);let i=await this.getCacheEntries(o.map(d=>d.id)),I=e.getTags();for(let d of o){let m=d.id,T=C(m);s.downrankedFoldersFilters.length>0&&(s.downrankedFoldersFilters.some(x=>T===x||T.startsWith(x+"/"))||T.split("/").some(x=>s.downrankedFoldersFilters.includes(x)))&&(d.score/=10);let h=i.find(y=>y.path===m);if(h)for(let[y,x]of Object.entries(s.weightCustomProperties)){let g=h.metadata[y];g&&d.terms.some(k=>g.includes(k))&&(d.score*=x)}for(let y of I)(h?.tags??[]).includes(y)&&(d.score*=100)}o=o.sort((d,m)=>m.score-d.score).slice(0,50);let p=e.getExactTerms();p.length&&(o=o.filter(d=>{let m=i.find(y=>y.path===d.id),T=m?.name.toLowerCase()??"",h=(m?.cleanedContent??"").toLowerCase();return p.every(y=>h.includes(y)||N(T,s.ignoreArabicDiacritics).includes(y))}));let l=e.query.exclude.text;return l.length&&(o=o.filter(d=>{let m=(i.find(T=>T.path===d.id)?.content??"").toLowerCase();return l.every(T=>!m.includes(T))})),o}async getSuggestions(e,t){let s=await this.search(e,{prefixLength:1,singleFilePath:t?.singleFilePath}),r=await this.getCacheEntries(s.map(o=>o.id));return(await Promise.all(s.map(async o=>{let i=r.find(T=>T.path===o.id);if(!i)return console.warn(`[Silversearch] Note "${o.name}" disappeared. Skipping`),null;let I=[...o.terms,...e.getExactTerms(),...e.getTags()],p=await Ge(i.content,I,e),l=await Ge(i.name,I),d;if(t?.singleFilePath){let T=En(p),h=e.getExactTerms();h.length&&(T=T.filter(x=>h.every(g=>x.some(k=>k.match.includes(g)))));let y=T.map(x=>Math.round(x.at(0).offset));d=await Promise.all(y.map(x=>Je(i?.content??"",x)))}else d=[await Je(i.content,p[0]?.offset??-1)];return{score:o.score,foundWords:I,matches:p,matchesName:l,excerpts:d,name:i.name,basename:i.basename,content:i.content,navigationMap:i.navigationMap}}))).filter(o=>o!==null)}runningCacheProcesses=new Map;async getCacheEntries(e){let t=e.map(async r=>{if(this.runningCacheProcesses.has(r))return this.runningCacheProcesses.get(r);let u=this.getCacheEntry(r);this.runningCacheProcesses.set(r,u);let o=await u;return this.runningCacheProcesses.delete(r),o});return(await Promise.all(t)).filter(r=>!!r)}async getCacheEntry(e){let t,s=this.entryCache.get(e);if(s)return s;try{let i=C(e);t=X(e)?await R.getPageMeta(i):await R.getDocumentMeta(i)}catch{return console.log("[Silversearch] Couldn't find the specified file:",e),null}let r=await n.pathToIndexableEntry(e,t);if(!r)return null;let u=Object.fromEntries(Object.entries(t).filter(([i,I])=>!["ref","tag","tags","itags","name","created","lastModified","perm","lastOpened","pageDecoration","aliases","extension","size","contentType"].includes(i))),o={...r.entry,...r.info,cleanedContent:bn(N(r.entry.content)),metadata:u,tags:t.tags?.map(i=>"#"+i)??[]};return this.entryCache.set(e,o),o}static async pathToIndexableEntry(e,t){let s=C(e),r;try{r=t??(X(e)?await R.getPageMeta(s):await R.getDocumentMeta(s))}catch{return null}let u=await Un(e,r);if(!u)return null;let o=Pn(u.content),i={path:e,name:s,content:o,basename:zn(s),directory:$n(s),aliases:r.aliases??[],displayName:r.displayName??"",unmarkedTags:r.tags??[],lastModified:new Date(r.lastModified).getTime()},{content:I,...p}=u;return{entry:i,info:p}}isIndexedPath(e){return!e.startsWith("_plug/")}static getOptions(e){return{tokenize:t=>Wn(t,{tokenizeUrls:e.tokenizeUrls}),processTerm:t=>(e.ignoreDiacritics?N(t,e.ignoreArabicDiacritics):t).toLowerCase(),idField:"path",fields:["content","basename","directory","aliases","displayName","unmarkedTags"],storeFields:["lastModified"]}}};var Qn=Qe(Xn()),He=["ext","path"],Te=class{query;#e;constructor(e="",t){t.ignoreDiacritics&&(e=N(e,t.ignoreArabicDiacritics));let s=(0,Qn.parse)(e.toLowerCase(),{tokenize:!0,keywords:He});s.text=s.text??[],s.exclude=s.exclude??{text:[]},s.exclude.text=s.exclude.text??[],Array.isArray(s.exclude.text)||(s.exclude.text=[s.exclude.text]),s.exclude.text=s.exclude.text.filter(u=>u.length);for(let u of He){let o=s[u];o&&(s[u]=Array.isArray(o)?o:[o]);let i=s.exclude[u];i&&(s.exclude[u]=Array.isArray(i)?i:[i])}this.query=s;let r=this.query.text.filter(u=>u.startsWith(".")).map(u=>u.slice(1));this.query.ext=[...new Set([...r,...this.query.ext??[]])],this.query.text=this.query.text.filter(u=>!u.startsWith(".")),this.#e=e.match(/"([^"]+)"/g)?.map(u=>u.replace(/"/g,""))??[]}isEmpty(){for(let e of He)if(this.query[e]?.length||this.query.text.length)return!1;return!0}segmentsToStr(){return this.query.text.join(" ")}getTags(){return this.query.text.filter(e=>e.startsWith("#"))}getTagsWithoutHashtag(){return this.getTags().map(e=>e.replace(/^#/,""))}getExactTerms(){return[...new Set([...this.query.text.filter(e=>e.split(" ").length>1),...this.#e].map(e=>e.toLowerCase()))]}getBestStringForExcerpt(){return this.#e.length?this.#e.sort((e,t)=>t.length-e.length)[0]??"":this.segmentsToStr()}};var Zn="1.1.6";var b=null,$=[];async function Xe(){if(b)return;let n=await V();b=await Q.loadFromCache(n),b?$.length&&(await b.indexByPaths($.filter(e=>e.action==="index").map(e=>e.path)),await b.deleteByPaths($.filter(e=>e.action==="delete").map(e=>e.path)),$=[]):(b=new Q(n),await b.reindex())}async function Yn(n=""){let e=await An();await B.showPanel("modal",1,e?`<style>${e}</style>`+Se:Se,n?`globalThis.DEFAULT_QUERY = ${JSON.stringify(n)};`+Oe:Oe)}async function et(){await c("silversearch.openSearch")}async function nt(){await Xe()}async function tt({name:n}){let e=`${n}.md`;b?await b.indexByPath(e):$.push({action:"index",path:e})}async function st(n){let e=n;b?await b.indexByPath(e):$.push({action:"index",path:e})}async function rt(n){b?await b.deleteByPath(n):$.push({action:"delete",path:n})}async function ut(n,e){await Xe();let t=await V(),s=new Te(n,{ignoreDiacritics:t.ignoreDiacritics,ignoreArabicDiacritics:t.ignoreArabicDiacritics});return b.getSuggestions(s,{singleFilePath:e})}async function ot(){await Q.deleteCache(),b=null,await Xe()}async function it(){await B.flashNotification(`Silversearch - Version ${Zn}`)}var at={startSearch:et,getVersion:it,openSearch:Yn,reindex:ot,init:nt,indexPage:tt,indexDocument:st,deleted:rt,search:ut},pt={name:"silversearch",functions:{startSearch:{path:"./worker/silversearch.ts:startSearch",command:{name:"Silversearch: Search",key:"Ctrl-s",mac:"Cmd-s"}},getVersion:{path:"./worker/silversearch.ts:showVersion",command:{name:"Silversearch: Version"}},openSearch:{path:"./worker/silversearch.ts:openSearch",syscall:"silversearch.openSearch"},reindex:{path:"./worker/silversearch.ts:reindex",syscall:"silversearch.reindex",command:{name:"Silversearch: Reindex"}},init:{path:"./worker/silversearch.ts:init",events:["editor:init"]},indexPage:{path:"./worker/silversearch.ts:indexPage",events:["page:index"]},indexDocument:{path:"./worker/silversearch.ts:indexDocument",events:["document:index"]},deleted:{path:"./worker/silversearch.ts:deleted",events:["file:deleted"]},search:{path:"./worker/silversearch.ts:search",syscall:"silversearch.search"}},assets:{}},kE={manifest:pt,functionMapping:at};nn(at,pt,self.postMessage);export{kE as plug};
/*! Bundled license information:

search-query-parser/lib/search-query-parser.js:
  (*!
   * search-query-parser.js
   * Copyright(c) 2014-2019
   * MIT Licensed
   *)
*/
